(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    292467,       7422]
NotebookOptionsPosition[    262884,       6530]
NotebookOutlinePosition[    263273,       6547]
CellTagsIndexPosition[    263230,       6544]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\

VIS Rigid-Body Model Utility Package
Modified for SUMCON\
\>", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.5109088633079133`*^9, 3.510908886523241*^9}, {
   3.5109089295327015`*^9, 3.5109089606324797`*^9}, {3.510998012935999*^9, 
   3.510998040953648*^9}, {3.511147199138874*^9, 3.511147201837679*^9}, 
   3.5111528655524273`*^9, {3.5112140422561007`*^9, 3.511214046727357*^9}, {
   3.511333214700381*^9, 3.5113332166191845`*^9}, {3.5113333850886836`*^9, 
   3.511333385931085*^9}, {3.5114221757606726`*^9, 3.511422198131112*^9}, {
   3.5114222490096016`*^9, 3.5114222553900127`*^9}, {3.5707840064250484`*^9, 
   3.570784007532112*^9}, {3.571491152494011*^9, 3.571491158161335*^9}}],

Cell[CellGroupData[{

Cell["Discription", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5054543012647257`*^9, 3.505454323450515*^9}, {
   3.510907714373198*^9, 3.5109077167963367`*^9}, 3.510908178125723*^9}],

Cell[CellGroupData[{

Cell["About This File", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.510394061790189*^9, 3.5103940822418246`*^9}, {
  3.510907707872826*^9, 3.5109077115670376`*^9}, {3.5114238488676147`*^9, 
  3.5114238493512154`*^9}}],

Cell["\<\
This file contains utilities that are useful when you make a model and \
simulate vibration isolation systems.
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.505454452255293*^9, 3.505454488921332*^9}, {
   3.5077129980500813`*^9, 3.5077130433695107`*^9}, {3.5078876676897573`*^9, 
   3.5078878698873224`*^9}, {3.507891500540996*^9, 3.5078915759671288`*^9}, {
   3.508056919436692*^9, 3.508056920357094*^9}, {3.510355123371209*^9, 
   3.51035514664645*^9}, {3.5103918876678514`*^9, 3.5103918944872417`*^9}, {
   3.510623942883439*^9, 3.510624004228547*^9}, {3.510624128264365*^9, 
   3.5106243303003197`*^9}, {3.510907735689417*^9, 3.510907763414003*^9}, {
   3.510909653179636*^9, 3.510909653834837*^9}, {3.5109584516502295`*^9, 
   3.5109584654874535`*^9}, {3.5109980702504997`*^9, 3.510998172181079*^9}, {
   3.5111293295678463`*^9, 3.5111293498580065`*^9}, {3.511129506365958*^9, 
   3.511129532635461*^9}, {3.511214054289789*^9, 3.511214075686013*^9}, {
   3.5114240034170866`*^9, 3.5114241156748834`*^9}, {3.5114250412401094`*^9, 
   3.5114250436737137`*^9}, {3.511670533758334*^9, 3.5116705492959614`*^9}, 
   3.512724773177787*^9, {3.51814847181927*^9, 3.5181484723403006`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Functions", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.51142744973974*^9, 3.5114274556677504`*^9}, {
  3.511427538098295*^9, 3.5114275409375*^9}}],

Cell[CellGroupData[{

Cell["Combine two lists.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510918135657544*^9, 3.5109181662023983`*^9}, 
   3.510955489646286*^9, {3.5116705056518855`*^9, 3.511670507555089*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"comb", "[", 
     RowBox[{"vec1_List", ",", "vec2_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vec1", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", 
         RowBox[{"vec2", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "vec1", "]"}]}], "}"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"Length", "[", "vec1", "]"}], "\[Equal]", 
      RowBox[{"Length", "[", "vec2", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106272519202514`*^9, 3.510627310373554*^9}, {
   3.510637868909706*^9, 3.510637893354949*^9}, {3.5109181567799816`*^9, 
   3.510918218010089*^9}, 3.510955489647286*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"comb", "::", "usage"}], "=", 
    "\"\<comb[vec1,vec2] combines two vectors.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.51142746714937*^9, 3.5114275289878793`*^9}, 
   3.571490551464634*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Combine three lists.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.510918135657544*^9, 3.5109181662023983`*^9}, 
   3.510955489646286*^9, {3.5116705056518855`*^9, 3.511670507555089*^9}, {
   3.5470731196550107`*^9, 3.547073120619066*^9}, 3.57149056119219*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"comb3", "[", 
     RowBox[{"vec1_List", ",", "vec2_List", ",", "vec3_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vec1", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", 
         RowBox[{"vec2", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", 
         RowBox[{"vec3", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"Length", "[", "vec1", "]"}]}], "}"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "vec1", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "vec2", "]"}]}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", "vec2", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "vec3", "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106272519202514`*^9, 3.510627310373554*^9}, {
   3.510637868909706*^9, 3.510637893354949*^9}, {3.5109181567799816`*^9, 
   3.510918218010089*^9}, 3.510955489647286*^9, {3.5470731231962132`*^9, 
   3.5470731601073246`*^9}, 3.57149056119219*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"comb3", "::", "usage"}], "=", 
    "\"\<comb[vec1,vec2,vec3] combines three vectors.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.51142746714937*^9, 3.5114275289878793`*^9}, {
  3.5470731661346693`*^9, 3.547073173433087*^9}, {3.5714905477144194`*^9, 
  3.57149056119219*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Create randum numbers.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5298104859782915`*^9, 3.5298104966799107`*^9}, 
   3.529810675160225*^9, 3.529816662606556*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"randomRG", "[", "r_Real", "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0", ",", "r"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"randomRG", "[", 
    RowBox[{"r_Real", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"0", ",", "r"}], "]"}], ",", "n"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"randomRG", "[", 
    RowBox[{"r_Real", ",", "nw_List"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "r"}], "]"}], ",", 
       RowBox[{"nw", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"Length", "[", "nw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.529809197859222*^9, 3.5298091980308223`*^9}, {
   3.529809775560439*^9, 3.5298097812856493`*^9}, {3.5298099474155436`*^9, 
   3.5298099518147507`*^9}, {3.529809986852412*^9, 3.529809988724416*^9}, {
   3.529810283194335*^9, 3.529810418852173*^9}, 3.529810675160225*^9, {
   3.529816662606556*^9, 3.529816701918625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"randumRG", "::", "usage"}], "=", 
    "\"\<randumRG[r] creates randum numbers with normal probability \
distribution with standard deviation r.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.529810500423917*^9, 3.5298105714196415`*^9}, {
   3.5298106224009323`*^9, 3.529810675160225*^9}, 3.529816662606556*^9, {
   3.5298167588431253`*^9, 3.529816759888327*^9}, 3.571490542569125*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Create randum numbers.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5298104859782915`*^9, 3.5298104966799107`*^9}, 
   3.529810675160225*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"randomR", "[", 
    RowBox[{"r1_Real", ",", "r2_Real"}], "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"randomR", "[", 
    RowBox[{"r1_Real", ",", "r2_Real", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r1", ",", "r2"}], "}"}], ",", "n"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"randomR", "[", 
    RowBox[{"r1_Real", ",", "r2_Real", ",", "nw_List"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r1", ",", "r2"}], "}"}], ",", 
       RowBox[{"nw", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"Length", "[", "nw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.529809197859222*^9, 3.5298091980308223`*^9}, {
   3.529809775560439*^9, 3.5298097812856493`*^9}, {3.5298099474155436`*^9, 
   3.5298099518147507`*^9}, {3.529809986852412*^9, 3.529809988724416*^9}, {
   3.529810283194335*^9, 3.529810418852173*^9}, 3.529810675160225*^9, {
   3.5298167358642845`*^9, 3.529816755161519*^9}, {3.530238904030982*^9, 
   3.5302389357614374`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"randomR", "[", "r_Real", "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "r"}], ",", "r"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"randomR", "[", 
    RowBox[{"r_Real", ",", "n_Integer"}], "]"}], ":=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"randomR", "[", 
    RowBox[{"r_Real", ",", "nw_List"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
       RowBox[{"nw", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"Length", "[", "nw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.529809197859222*^9, 3.5298091980308223`*^9}, {
   3.529809775560439*^9, 3.5298097812856493`*^9}, {3.5298099474155436`*^9, 
   3.5298099518147507`*^9}, {3.529809986852412*^9, 3.529809988724416*^9}, {
   3.529810283194335*^9, 3.529810418852173*^9}, 3.529810675160225*^9, {
   3.5298167358642845`*^9, 3.529816755161519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"randumR", "::", "usage"}], "=", 
    "\"\<randumR[r] creates randum numbers in the range -r to r.\>\""}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.529810500423917*^9, 3.5298105714196415`*^9}, {
   3.5298106224009323`*^9, 3.529810675160225*^9}, {3.5298168406172705`*^9, 
   3.529816868276119*^9}, 3.5714905375408373`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Geometry", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5114223223765306`*^9, 3.5114223366193557`*^9}, {
  3.511422374921823*^9, 3.5114223771214266`*^9}, {3.5114237895095105`*^9, 
  3.5114237930663166`*^9}, {3.5114250256244817`*^9, 3.5114250261392827`*^9}}],

Cell[CellGroupData[{

Cell["Coordinate System", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5103935324149256`*^9, 3.510393535246088*^9}, {
  3.5103940971398506`*^9, 3.5103941199158907`*^9}}],

Cell["\<\
(VIRGO's Reference)
X-axis:  Transversal, Y-axis: Vertical, Z-axis: Longitudinal (Beam-axis)
Pitch: Rotation around x-axis, Yaw: Rotation around y-axis, Roll: Rotation \
around z-axis
\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5103935528940973`*^9, 3.510393696350746*^9}, {
   3.510394123098296*^9, 3.5103943553983045`*^9}, {3.510395802459265*^9, 
   3.510395835515723*^9}, {3.510624429500894*^9, 3.510624435179304*^9}, {
   3.5109079621453695`*^9, 3.510908048918333*^9}, {3.5109081088107586`*^9, 
   3.5109081217995014`*^9}, 3.512773516270962*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic Operations for Vectors", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511422416464696*^9, 3.511422418461499*^9}, {
   3.5114231295497503`*^9, 3.5114231406101694`*^9}, 3.51142417050898*^9}],

Cell[CellGroupData[{

Cell["\<\
Norm of real vector, square value of real vector, and vector normalization.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.510624811857566*^9, 3.5106248241191874`*^9}, {
  3.510624876457279*^9, 3.5106248775024805`*^9}, {3.510916184296917*^9, 
  3.5109162220333834`*^9}, {3.5109689177143297`*^9, 3.5109689227843385`*^9}, {
  3.51130122640486*^9, 3.511301360580696*^9}, {3.511301421920004*^9, 
  3.511301499998141*^9}, {3.5113016850456657`*^9, 3.511301686028467*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sqvec", "[", "vec_", "]"}], ":=", 
   RowBox[{"vec", ".", "vec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"norm", "[", "vec_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"vec", ".", "vec"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalize", "[", "vec_", "]"}], ":=", 
   RowBox[{"vec", "/", 
    RowBox[{"norm", "[", "vec", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.510558303399193*^9, 3.5105583566888866`*^9}, {
  3.510624832480802*^9, 3.5106248641800575`*^9}, {3.5106282518508077`*^9, 
  3.5106283007256937`*^9}, {3.51091621465457*^9, 3.5109162220333834`*^9}, {
  3.5109688914126835`*^9, 3.5109689090563145`*^9}, {3.511301505832551*^9, 
  3.5113015164561696`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sqvec", "::", "usage"}], "=", 
   "\"\<sqvec[vec] calculates the square value of the input vector.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"norm", "::", "usage"}], "=", 
   "\"\<norm[vec] calculates the norm of the input vector.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalize", "::", "usage"}], "=", 
   "\"\<normalize[vec] normalizes the input vector.\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.510558303399193*^9, 3.5105583566888866`*^9}, {
  3.510624832480802*^9, 3.5106248641800575`*^9}, {3.5106282518508077`*^9, 
  3.5106283007256937`*^9}, {3.51091621465457*^9, 3.5109162220333834`*^9}, {
  3.5109688914126835`*^9, 3.5109689090563145`*^9}, {3.511301505832551*^9, 
  3.5113015164561696`*^9}, {3.5114224526255593`*^9, 3.511422671681144*^9}, {
  3.5114228745643015`*^9, 3.5114228776219063`*^9}, {3.511423156163397*^9, 
  3.5114231828394437`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordiate Transformation", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511422416464696*^9, 3.511422418461499*^9}, {
  3.5114231184425306`*^9, 3.5114231217965364`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Rotation Matrix (Rotation around X-axis[pitch] > Y-axis[yaw] > Z-axis[roll])\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.510624787271922*^9, 3.5106248071931577`*^9}, {
   3.5109152818041315`*^9, 3.5109152824437327`*^9}, {3.5109153395710335`*^9, 
   3.510915351271054*^9}, {3.5109153911291237`*^9, 3.5109154637472515`*^9}, 
   3.5114230214385595`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rotX", "[", "theta_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Cos", "[", "theta", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Sin", "[", "theta", "]"}], ",", 
       RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rotY", "[", "theta_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], ",", "0", ",", 
       RowBox[{"Sin", "[", "theta", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0", ",", 
       RowBox[{"Cos", "[", "theta", "]"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rotZ", "[", "theta_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "theta", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "theta", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "theta", "]"}], ",", 
       RowBox[{"Cos", "[", "theta", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotXYZ", "[", 
    RowBox[{"{", 
     RowBox[{"pitch_", ",", "yaw_", ",", "roll_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"rotZ", "[", "roll", "]"}], ".", 
    RowBox[{"rotY", "[", "yaw", "]"}], ".", 
    RowBox[{"rotX", "[", "pitch", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5105423220449114`*^9, 3.5105423508893623`*^9}, {
   3.510542406051059*^9, 3.510542410403466*^9}, {3.510542454177143*^9, 
   3.5105425265924706`*^9}, {3.5105427581280775`*^9, 3.510542848577036*^9}, {
   3.510543065261417*^9, 3.5105430695358243`*^9}, {3.510543329728681*^9, 
   3.5105433653747435`*^9}, {3.5105576075131702`*^9, 
   3.5105576107423763`*^9}, {3.510557744341011*^9, 3.510557745573413*^9}, {
   3.5108206624331646`*^9, 3.510820684678804*^9}, 3.5109153911291237`*^9, 
   3.51091599246338*^9, {3.511139925231698*^9, 3.5111399315497093`*^9}, 
   3.5114230214385595`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rotXYZ", "::", "usage"}], "=", 
    "\"\<rotXYZ[{pitch,yaw,roll}] generates a rotation matrix which\nrotates \
a vector by 'pitch' around x-axis, 'yaw' around y-axis, and then\n'roll' \
around z-axis.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.511422735906457*^9, 3.511422816215398*^9}, {
   3.5114228804923115`*^9, 3.5114230214385595`*^9}, 3.571489121281832*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Function to convert local body coordinate to system coordinate.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.510626325809025*^9, 3.5106263437178564`*^9}, 
   3.5109158617039504`*^9, {3.510915905508827*^9, 3.5109159528237104`*^9}, {
   3.510955179627554*^9, 3.5109551797685623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b2s", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x_", ",", "y_", ",", "z_", ",", "pitch_", ",", "yaw_", ",", "roll_"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xb_", ",", "yb_", ",", "zb_"}], "}"}]}], "]"}], " ", ":=", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], "+", 
      RowBox[{
       RowBox[{"rotXYZ", "[", 
        RowBox[{"{", 
         RowBox[{"pitch", ",", "yaw", ",", "roll"}], "}"}], "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"xb", ",", "yb", ",", "zb"}], "}"}]}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5105430584598045`*^9, 3.5105430592866063`*^9}, {
   3.510543125555523*^9, 3.5105431286131277`*^9}, {3.510543497054575*^9, 
   3.510543502405384*^9}, {3.510543681290899*^9, 3.5105436820085*^9}, {
   3.5105454365123816`*^9, 3.5105454529860106`*^9}, {3.5106360515049143`*^9, 
   3.510636061301731*^9}, {3.5108253468257957`*^9, 3.5108253475901966`*^9}, 
   3.5109158617039504`*^9, {3.5109160221034317`*^9, 3.510916028234243*^9}, {
   3.511139938335721*^9, 3.511139940098524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"b2s", "::", "usage"}], "=", 
    "\"\<b2s[{x,y,z,yaw,pitch,roll},{xb,yb,zb}] gives the space coordinates \n\
for a point at body coordinates {xb,yb,zb} on the object defined by \
{x,y,z,yaw,pitch,roll}.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5105430584598045`*^9, 3.5105430592866063`*^9}, {
   3.510543125555523*^9, 3.5105431286131277`*^9}, {3.510543497054575*^9, 
   3.510543502405384*^9}, {3.510543681290899*^9, 3.5105436820085*^9}, {
   3.5105454365123816`*^9, 3.5105454529860106`*^9}, {3.5106360515049143`*^9, 
   3.510636061301731*^9}, {3.5108253468257957`*^9, 3.5108253475901966`*^9}, 
   3.5109158617039504`*^9, {3.5109160221034317`*^9, 3.510916028234243*^9}, {
   3.511139938335721*^9, 3.511139940098524*^9}, {3.5114230464610033`*^9, 
   3.511423052155013*^9}, {3.511423199453473*^9, 3.511423239467543*^9}, {
   3.511423488926382*^9, 3.511423523698843*^9}, 3.5714891148014617`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
A Matrix that converts a differential angular displacement from incremental \
pitch/yaw/roll representation to body coordinate.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{
  3.510915481780883*^9, {3.510915720991703*^9, 3.510915797088637*^9}, 
   3.5109158531707354`*^9, 3.5114236860639277`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"omegaIB", "[", 
     RowBox[{"{", 
      RowBox[{"pitch_", ",", "yaw_", ",", "roll_"}], "}"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "yaw", "]"}], " ", 
         RowBox[{"Cos", "[", "pitch", "]"}]}], ",", "0", ",", "0"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "yaw", "]"}], " ", 
         RowBox[{"Sin", "[", "pitch", "]"}]}], ",", 
        RowBox[{"Cos", "[", "pitch", "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "yaw", "]"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "pitch", "]"}]}], ",", "1"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106551106823483`*^9, 3.5106551219611683`*^9}, {
   3.5106552892870617`*^9, 3.510655304185088*^9}, {3.5106555734675617`*^9, 
   3.5106555799727726`*^9}, {3.5108207043816385`*^9, 
   3.5108207253012753`*^9}, {3.510822517963627*^9, 3.5108225865257473`*^9}, {
   3.5108226191142044`*^9, 3.5108226344958315`*^9}, 3.5109158531707354`*^9, {
   3.5109159944757833`*^9, 3.510916006831005*^9}, {3.511139975806987*^9, 
   3.5111399784277916`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"omegaIB", "::", "usage"}], "=", 
    "\"\<omegaIB[{pitch,yaw,roll}] is a matrix that converts a differential \n\
angular displacement from incremental pitch/yaw/roll representation to body \
coordinate.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106551106823483`*^9, 3.5106551219611683`*^9}, {
   3.5106552892870617`*^9, 3.510655304185088*^9}, {3.5106555734675617`*^9, 
   3.5106555799727726`*^9}, {3.5108207043816385`*^9, 
   3.5108207253012753`*^9}, {3.510822517963627*^9, 3.5108225865257473`*^9}, {
   3.5108226191142044`*^9, 3.5108226344958315`*^9}, 3.5109158531707354`*^9, {
   3.5109159944757833`*^9, 3.510916006831005*^9}, {3.511139975806987*^9, 
   3.5111399784277916`*^9}, {3.5114236593254814`*^9, 3.511423712895975*^9}, 
   3.5714891089921293`*^9}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Variables", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5114241928794193`*^9, 3.511424194642222*^9}, {
  3.511424225889077*^9, 3.5114242323786883`*^9}, {3.5114248806846275`*^9, 
  3.511424881620629*^9}}],

Cell[CellGroupData[{

Cell["Usage Notes", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114242705831556`*^9, 3.511424273765561*^9}}],

Cell[CellGroupData[{

Cell["Usage notes for allvars, allparams and allfloats.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511424282173976*^9, 3.51142430134641*^9}, {
  3.5114248883442407`*^9, 3.5114249111358805`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"allvars", "::", "usage"}], "=", 
   "\"\<allvars is part of the specification of the model. It should be a \
list of the position and angle variables for all elements of the system that \
have mass/MOI associated with them.\>\""}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114246489618196`*^9, 3.511424763419221*^9}, {
  3.5114248268177323`*^9, 3.511424833432144*^9}, {3.5114249048490696`*^9, 
  3.5114249111358805`*^9}, {3.5127233514564695`*^9, 3.512723356939783*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"allparams", "::", "usage"}], "=", 
   "\"\<allparams is part of the specification of the model. It should be a \
list of the positions and angles describing the state of the ground.\>\""}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114246489618196`*^9, 3.511424763419221*^9}, {
  3.5114248268177323`*^9, 3.511424833432144*^9}, {3.5114249048490696`*^9, 
  3.5114249111358805`*^9}, {3.5127233685574474`*^9, 3.512723370818577*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"allfloats", "::", "usage"}], " ", "=", " ", 
    "\"\<allfloats is part of the specification of the model. \nIt should be \
a list of the positions and angles of connections where one elastic element \
is connected directly to another with no mass element between.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114248005940866`*^9, 3.5114248403585567`*^9}, 
   3.5114249111358805`*^9, {3.5127233740857635`*^9, 3.5127233755188456`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Substitution", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511424263438343*^9, 3.5114242647019453`*^9}, {
  3.5114268254578433`*^9, 3.511426828031848*^9}}],

Cell[CellGroupData[{

Cell["\<\
Function to generate substitution which replaces a list of variables to a \
list of values.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.510913482340971*^9, 3.5109135782187395`*^9}, 
   3.5109136335052366`*^9, {3.510967427287712*^9, 3.5109674383013315`*^9}, {
   3.5109677600674963`*^9, 3.5109677949179573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makesub", "[", 
     RowBox[{"var_List", ",", "val_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"var", "[", 
         RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", 
        RowBox[{"val", "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"Length", "[", "var", "]"}], "\[Equal]", 
      RowBox[{"Length", "[", "val", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109126417406907`*^9, 3.5109126583235197`*^9}, {
   3.510912707604007*^9, 3.5109127338744526`*^9}, {3.510912901567551*^9, 
   3.5109129017391515`*^9}, {3.5109130195349584`*^9, 
   3.5109130213913617`*^9}, {3.5109132786202135`*^9, 3.510913281287818*^9}, {
   3.51091335633955*^9, 3.5109133641863637`*^9}, {3.510913412265648*^9, 
   3.510913438442494*^9}, 3.5109136335052366`*^9, 3.5109550397325525`*^9, {
   3.510967427287712*^9, 3.5109674383013315`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makesub", "::", "usage"}], "=", 
   "\"\<makesub[var_List,val_List] makes a substitution whichreplaces a list \
of variables (var) to a list of values (val).\>\""}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114244517774734`*^9, 3.511424537562024*^9}, 
   3.511424925955907*^9, 3.512723384100336*^9}]
}, Closed]],

Cell[BoxData["\<\"makesub[var_List,val_List] makes a substitution \
whichreplaces a list of variables (var) to a list of values (val).\"\>"], \
"Output",
 InitializationCell->True,
 CellChangeTimes->{3.5709004395715213`*^9}],

Cell[CellGroupData[{

Cell["\<\
Function to generate substitution which converts all the variables to zero.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510913482340971*^9, 3.5109135782187395`*^9}, 
   3.5109136335052366`*^9, {3.510959214647569*^9, 3.5109592295455956`*^9}, {
   3.510967427287712*^9, 3.5109674420453377`*^9}, 3.511424922695501*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makesub0", "[", "var_List", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"var", "[", 
        RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109126417406907`*^9, 3.5109126583235197`*^9}, {
   3.510912707604007*^9, 3.5109127338744526`*^9}, {3.510912901567551*^9, 
   3.5109129017391515`*^9}, {3.5109130195349584`*^9, 
   3.5109130213913617`*^9}, {3.5109132786202135`*^9, 3.510913281287818*^9}, {
   3.51091335633955*^9, 3.5109133641863637`*^9}, {3.510913412265648*^9, 
   3.510913438442494*^9}, 3.5109136335052366`*^9, 3.5109550397325525`*^9, {
   3.5109592346780043`*^9, 3.5109592464092255`*^9}, {3.510967427287712*^9, 
   3.5109674420453377`*^9}, 3.511424922695501*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makesub0", "::", "usage"}], "=", 
    "\"\<makesub0[var_List] makes a substitution which replaces all the \
variables in the var_List to zero.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511424545830039*^9, 3.5114246115529547`*^9}, 
   3.511424922695501*^9, {3.5127233869725003`*^9, 3.512723388327578*^9}, 
   3.571489090963098*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Velocities", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114258873855953`*^9, 3.511425889944*^9}, {
  3.51142683469306*^9, 3.511426835504261*^9}}],

Cell[CellGroupData[{

Cell["Function to generate corresponding velocity list.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
  3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
  3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makevel", "[", "var_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<v\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"var", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "var", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916799078397*^9, 3.510916858966902*^9}, {
  3.5111348969684663`*^9, 3.5111349719265985`*^9}, {3.5111350102870655`*^9, 
  3.51113501279867*^9}, {3.5111351809825654`*^9, 3.5111351940709887`*^9}, {
  3.5111352382658663`*^9, 3.5111352443030767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makevel", "::", "usage"}], "=", 
    "\"\<makevel[var_List] generates corresponding velocity set with input \
list of variables.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114243293640585`*^9, 3.5114244430258584`*^9}, 
   3.511424928966712*^9, {3.5114275623719378`*^9, 3.5114275714199533`*^9}, 
   3.5127233923228064`*^9, 3.571490527343254*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Substitution to replace derivatives of the coodinate with velocity coordinate.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.511135303910781*^9, 3.5111353478872585`*^9}, 
   3.5111388497814093`*^9, 3.5114269351260357`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tovel", " ", ":=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dt", "[", 
          RowBox[{
           RowBox[{"allvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         RowBox[{"velvars", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dt", "[", 
          RowBox[{
           RowBox[{"allparams", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         RowBox[{"velparams", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "allparams", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dt", "[", 
          RowBox[{
           RowBox[{"allfloats", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", "t"}], "]"}], "\[Rule]", 
         RowBox[{"velfloats", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "allfloats", "]"}]}], "}"}]}], "]"}]}], "\n",
      "\t", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5111353853741245`*^9, 3.511135397261345*^9}, {
   3.5111354479926343`*^9, 3.511135652758594*^9}, {3.511135713707901*^9, 
   3.511135729448329*^9}, {3.511135784859626*^9, 3.5111358126744747`*^9}, {
   3.5111383023764477`*^9, 3.5111383357137065`*^9}, 3.5111388497814093`*^9, {
   3.5111504438197737`*^9, 3.5111504456917768`*^9}, 3.5114269351260357`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tovel", "::", "usage"}], "=", 
    "\"\<tovel is a substitution which replaces time derivatives of the \
coordinate to velocity coordinate.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114243293640585`*^9, 3.5114244430258584`*^9}, 
   3.511424928966712*^9, {3.5114268464710803`*^9, 3.5114268951431656`*^9}, 
   3.5114269351260357`*^9, {3.5127233961950283`*^9, 3.5127233972700896`*^9}, 
   3.5714905233930283`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Time derivative for a list of variables.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.511138484210367*^9, 3.5111384873615727`*^9}, {
   3.5111385189984283`*^9, 3.5111385243336377`*^9}, {3.5111385819757385`*^9, 
   3.5111385822877398`*^9}, {3.511138835257784*^9, 3.5111388594534264`*^9}, 
   3.5114270576642513`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"timeD", "[", "v_List", "]"}], ":=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Dt", "[", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "v", "]"}]}], "}"}]}], "]"}], "/.", 
     "tovel"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5111384911523795`*^9, 3.5111385898069525`*^9}, {
   3.511138751563637*^9, 3.511138753872441*^9}, 3.511138853104215*^9, 
   3.5114270576642513`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"timeD", "::", "usage"}], "=", 
    "\"\<timeD[var_List] is a time derivative used for a list of variables.\>\
\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.511426942426849*^9, 3.5114270576642513`*^9}, 
   3.5714905176977024`*^9}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy Calculation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5114249880908155`*^9, 3.5114250141272616`*^9}}],

Cell[CellGroupData[{

Cell["Usage Notes", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511425074873768*^9, 3.51142508131658*^9}}],

Cell[CellGroupData[{

Cell["Body", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114252483772726`*^9, 3.5114252571444883`*^9}}],

Cell[CellGroupData[{

Cell["Usage note for \"bodylist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914645962615*^9, 3.5109146506738234`*^9}, {3.510914804271693*^9, 
   3.5109148120249066`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.510965698133875*^9, 3.510965698508275*^9}, {
   3.510966244025634*^9, 3.510966244680835*^9}, {3.5109954858306274`*^9, 
   3.5109954868196845`*^9}, {3.5110759877958846`*^9, 3.5110759889970865`*^9}, 
   3.5113261211337137`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bodylist", "::", "usage"}], "=", " ", 
   "\"\<bodylist is a list of structures defining bodies. Each structure \
containing the following items:\n\tcoordinate list defining the body,\n\t\
mass,\n\tmoment of inertia tensor,\n\tshape,\n\tdimension\>\""}], ";"}], "\n", 
 RowBox[{"  "}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914683371481*^9, 3.5109147914640703`*^9}, {3.510914823459727*^9, 
   3.5109148388257537`*^9}, {3.5109148951262527`*^9, 
   3.5109149745771923`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109159867381697`*^9, 
   3.5109159889065733`*^9}, {3.510917661416711*^9, 3.5109176666583204`*^9}, {
   3.5109657010042796`*^9, 3.5109657511895676`*^9}, {3.510995616258088*^9, 
   3.5109956571064243`*^9}, 3.5113261211337137`*^9, {3.5114251108162313`*^9, 
   3.511425146462294*^9}, {3.51167206815983*^9, 3.511672068456231*^9}, 
   3.5127234033484373`*^9, {3.5127234914624767`*^9, 3.5127235490767727`*^9}, {
   3.512723822058386*^9, 3.5127239217550883`*^9}, {3.51272396759871*^9, 
   3.5127240529395914`*^9}, {3.5127241386224923`*^9, 3.51272414102363*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Index constants for elements of \"bodylist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109155299069676`*^9, 3.5109155451793947`*^9}, 
   3.5109156503703794`*^9, {3.5109662226847963`*^9, 3.510966223121597*^9}, 
   3.51097580674883*^9, 3.5113261211337137`*^9, {3.5114251633415236`*^9, 
   3.511425169768735*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"b$pos", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b$mass", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b$moi", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b$shape", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b$size", "=", "5"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.510915549531802*^9, 3.5109156503703794`*^9}, 
   3.510915990716177*^9, {3.5109176125106254`*^9, 3.5109176216366415`*^9}, {
   3.5109657642935905`*^9, 3.5109657706428022`*^9}, {3.5109658273021016`*^9, 
   3.510965828331703*^9}, {3.510966050023693*^9, 3.510966070303728*^9}, {
   3.5109662138239803`*^9, 3.5109662145571814`*^9}, {3.5109665578045845`*^9, 
   3.5109665590993867`*^9}, {3.5109669011611876`*^9, 3.510966901332788*^9}, {
   3.5109955871234217`*^9, 3.5109956081506243`*^9}, 3.5113261211337137`*^9, 
   3.5114251633415236`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Wire", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114252610288954`*^9, 3.5114252614656963`*^9}}],

Cell[CellGroupData[{

Cell["Usage note for \"wirelist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914645962615*^9, 3.5109146506738234`*^9}, {3.510914804271693*^9, 
   3.5109148120249066`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109662405936275`*^9, 
   3.5109662413112288`*^9}, {3.510995481933405*^9, 3.5109954831044717`*^9}, {
   3.511075984426279*^9, 3.511075985596281*^9}, 3.5113261272801247`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wirelist", "::", "usage"}], "=", 
   "\"\<wirelist is a list of structures defining wires. Each structure \
containing the following items:\n\tcoordinate list defining first mass,\n\t\
attachment point for first mass (local coordinates),\n\tcoordinate list \
defining second mass,\n\tattachment point for second mass (local \
coordinates),\n\tunstretched length,\n\tstretching elasticity,\n\ttorsional \
elasticity,\n\tloss angle of the stretching mode,\n\tloss angle of the \
bending mode,\n\tloss angle of the torsion mode,\>\""}], ";"}], "\n", 
 RowBox[{"  "}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914683371481*^9, 3.5109147914640703`*^9}, {3.510914823459727*^9, 
   3.5109148388257537`*^9}, {3.5109148951262527`*^9, 
   3.5109149745771923`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109159867381697`*^9, 
   3.5109159889065733`*^9}, {3.510917661416711*^9, 3.5109176666583204`*^9}, {
   3.5110015502262306`*^9, 3.511001565202257*^9}, {3.5113261273269243`*^9, 
   3.5113261473885593`*^9}, {3.511425188691568*^9, 3.511425214946414*^9}, 
   3.5114253541766586`*^9, {3.511672072278238*^9, 3.511672072543438*^9}, {
   3.5127235917012105`*^9, 3.5127236343106475`*^9}, {3.5231540963527613`*^9, 
   3.523154188892124*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Index constants for elements of \"wirelist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109155299069676`*^9, 3.5109155451793947`*^9}, 
   3.5109156503703794`*^9, 3.510975805204427*^9, {3.5113261348617373`*^9, 
   3.5113261473885593`*^9}, {3.5114252282532377`*^9, 3.511425230094041*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"w$bod1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$pos1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$bod2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$pos2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$nlen", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$kstr", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$ktor", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$slos", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$blos", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w$tlos", "=", "10"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.510915549531802*^9, 3.5109156503703794`*^9}, 
   3.510915990716177*^9, {3.5109176125106254`*^9, 3.5109176216366415`*^9}, {
   3.5110015738758717`*^9, 3.5110015906147013`*^9}, {3.5113261348617373`*^9, 
   3.5113261473885593`*^9}, 3.5114252282532377`*^9, {3.5231540842315407`*^9, 
   3.5231540861815443`*^9}, {3.52315412964322*^9, 3.5231541350096292`*^9}, {
   3.5231541975657396`*^9, 3.5231542182669764`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Spring", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114252688757086`*^9, 3.51142526956211*^9}}],

Cell[CellGroupData[{

Cell["Usage note for \"springlist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914645962615*^9, 3.5109146506738234`*^9}, {3.510914804271693*^9, 
   3.5109148120249066`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.510965698133875*^9, 3.510965698508275*^9}, {
   3.510966244025634*^9, 3.510966244680835*^9}, {3.5109954858306274`*^9, 
   3.5109954868196845`*^9}, {3.511075778037916*^9, 3.511075778817918*^9}, {
   3.511075991493091*^9, 3.511075992897094*^9}, 3.511326157200977*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"springlist", "::", "usage"}], "=", 
   "\"\<springlist is a list of structures defining GAS springs. Each \
structure containing the following items:\n\tcoordinate list defining first \
mass,\n\tworking point at first mass (local coordinate)\n\tcoordinate list \
defining second mass,\n\tattached point at second mass (local coordinate)\n\t\
spring constant tensor (6x6),\n\tstoring force element vector (6x1),\n\t\
spring constant tensor with imaginary part (6x6)\>\""}], ";"}], "\n", 
 RowBox[{"\t"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914683371481*^9, 3.5109147914640703`*^9}, {3.510914823459727*^9, 
   3.5109148388257537`*^9}, {3.5109148951262527`*^9, 
   3.5109149745771923`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109159867381697`*^9, 
   3.5109159889065733`*^9}, {3.510917661416711*^9, 3.5109176666583204`*^9}, {
   3.5109657010042796`*^9, 3.5109657511895676`*^9}, {3.510995616258088*^9, 
   3.5109956571064243`*^9}, {3.511075781469922*^9, 3.5110757886927347`*^9}, {
   3.511075901449733*^9, 3.511075903508937*^9}, {3.511075965597046*^9, 
   3.511075978404668*^9}, {3.5110760146747317`*^9, 3.5110760551100025`*^9}, {
   3.5110779873410187`*^9, 3.5110781327956743`*^9}, {3.511078313365991*^9, 
   3.5110783853757176`*^9}, {3.5110784524714355`*^9, 
   3.5110784555602407`*^9}, {3.5110785976608906`*^9, 
   3.5110786403425655`*^9}, {3.511130779742791*^9, 3.5111308372230787`*^9}, {
   3.511130967359964*^9, 3.511130996828416*^9}, {3.5111342046548505`*^9, 
   3.511134209366059*^9}, 3.511326157200977*^9, {3.511425274850519*^9, 
   3.511425299654563*^9}, 3.511425350994253*^9, {3.5127236421590967`*^9, 
   3.5127236698016777`*^9}, {3.512726864370372*^9, 3.512726867973978*^9}, {
   3.5181486363466806`*^9, 3.51814865189257*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Index constants for elements of \"springlist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109155299069676`*^9, 3.5109155451793947`*^9}, 
   3.5109156503703794`*^9, {3.5109662226847963`*^9, 3.510966223121597*^9}, 
   3.51097580674883*^9, {3.5110760706164303`*^9, 3.511076072348033*^9}, 
   3.511326157200977*^9, {3.5114253050989723`*^9, 3.5114253212294006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s$bod1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s$pos1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s$bod2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s$pos2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s$kmat", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s$fvec", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s$cmat", "=", "7"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.510915549531802*^9, 3.5109156503703794`*^9}, 
   3.510915990716177*^9, {3.5109176125106254`*^9, 3.5109176216366415`*^9}, {
   3.5109657642935905`*^9, 3.5109657706428022`*^9}, {3.5109658273021016`*^9, 
   3.510965828331703*^9}, {3.510966050023693*^9, 3.510966070303728*^9}, {
   3.5109662138239803`*^9, 3.5109662145571814`*^9}, {3.5109665578045845`*^9, 
   3.5109665590993867`*^9}, {3.5109669011611876`*^9, 3.510966901332788*^9}, {
   3.5109955871234217`*^9, 3.5109956081506243`*^9}, {3.51112979085323*^9, 
   3.5111297953714886`*^9}, {3.5111308457835684`*^9, 3.51113085928034*^9}, {
   3.5111308904161215`*^9, 3.511130899503641*^9}, {3.5111310524893136`*^9, 
   3.5111310748285527`*^9}, {3.51113218912291*^9, 3.5111321939901185`*^9}, {
   3.511134018031723*^9, 3.5111340218537292`*^9}, {3.5111341953884344`*^9, 
   3.511134201659645*^9}, {3.5111343986411915`*^9, 3.5111344057080035`*^9}, 
   3.511326157200977*^9, 3.5114253050989723`*^9, {3.5127268716711845`*^9, 
   3.5127268733715878`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Usage note for \"damperlist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914645962615*^9, 3.5109146506738234`*^9}, {3.510914804271693*^9, 
   3.5109148120249066`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109662405936275`*^9, 
   3.5109662413112288`*^9}, {3.510995481933405*^9, 3.5109954831044717`*^9}, {
   3.511075984426279*^9, 3.511075985596281*^9}, 3.5113261272801247`*^9, {
   3.511388506997878*^9, 3.51138850757508*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"damperlist", "::", "usage"}], "=", 
   "\"\<damperlist is is a list of structures defining dampers. Each \
structure containing the following items:\n\tcoordinate list defining first \
mass,\n\tattachment point for first mass (local coordinates),\n\tcoordinate \
list defining second mass,\n\tattachment point for second mass (local \
coordinates),\n\tdamping coefficient matrix (6x6)\>\""}], ";"}], "\n", 
 RowBox[{"  "}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
  3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
  3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
  3.510914683371481*^9, 3.5109147914640703`*^9}, {3.510914823459727*^9, 
  3.5109148388257537`*^9}, {3.5109148951262527`*^9, 3.5109149745771923`*^9}, {
  3.5109152254256325`*^9, 3.5109152326952457`*^9}, {3.5109159867381697`*^9, 
  3.5109159889065733`*^9}, {3.510917661416711*^9, 3.5109176666583204`*^9}, {
  3.5110015502262306`*^9, 3.511001565202257*^9}, {3.5113261273269243`*^9, 
  3.5113261473885593`*^9}, {3.511388512941489*^9, 3.5113885369811316`*^9}, {
  3.5114253261122093`*^9, 3.5114253476558475`*^9}, {3.5127236756920147`*^9, 
  3.5127236855915804`*^9}, {3.5181486555827813`*^9, 3.518148659705017*^9}, {
  3.522545937070416*^9, 3.5225459423276253`*^9}, {3.52254597357448*^9, 
  3.522545978020488*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Index constants for elements of \"damperlist\"", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109155299069676`*^9, 3.5109155451793947`*^9}, 
   3.5109156503703794`*^9, 3.510975805204427*^9, {3.5113261348617373`*^9, 
   3.5113261473885593`*^9}, {3.5113886236080832`*^9, 3.511388625121286*^9}, 
   3.5114253688874846`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d$bod1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d$pos1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d$bod2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d$pos2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d$dmat", "=", "5"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.510915549531802*^9, 3.5109156503703794`*^9}, 
   3.510915990716177*^9, {3.5109176125106254`*^9, 3.5109176216366415`*^9}, {
   3.5110015738758717`*^9, 3.5110015906147013`*^9}, {3.5113261348617373`*^9, 
   3.5113261473885593`*^9}, {3.5113885434083424`*^9, 3.511388562643176*^9}, 
   3.5114253688874846`*^9, {3.522545934028411*^9, 3.522545999111725*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy Calculation", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511425589019471*^9, 3.511425602029894*^9}, {
  3.511425793879031*^9, 3.511425795548234*^9}}],

Cell[CellGroupData[{

Cell["Wire Stretching Potential", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.51142561098431*^9, 3.51142561660032*^9}, {
  3.5114257867654185`*^9, 3.51142579898024*^9}}],

Cell[CellGroupData[{

Cell["Function to generate wire stretching potentials.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109160605418997`*^9, 3.510916071430719*^9}, 
   3.510916159695674*^9, 3.5114261403244395`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makewirepot", "[", "w_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], 
       RowBox[{"w", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "w$kstr"}], "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"norm", "[", 
           RowBox[{
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod1"}], "]"}], "]"}], ",", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos1"}], "]"}], "]"}]}], "]"}], "-", 
            "\[IndentingNewLine]", 
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod2"}], "]"}], "]"}], ",", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos2"}], "]"}], "]"}]}], "]"}]}], "]"}], 
          "-", 
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$nlen"}], "]"}], "]"}]}], ")"}], "2"]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "w", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.510917696625973*^9}, {3.510918860216417*^9, 3.510918860700018*^9}, {
   3.5114256659744062`*^9, 3.511425702946471*^9}, 3.5114261403244395`*^9, {
   3.523154250621433*^9, 3.5231542522906356`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makewirepot", "::", "usage"}], "=", 
    "\"\<makewirepot[wirelist] calculates real part of wire stretching \
potentials from 'wirelist'.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114259893941746`*^9, 3.5114261403244395`*^9}, 
   3.512723721989662*^9, 3.5297081154672966`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Function to generate wire stretching potentials with imaginary part of spring \
constants.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109160605418997`*^9, 3.510916071430719*^9}, 
   3.510916159695674*^9, {3.510917709074795*^9, 3.510917713130802*^9}, {
   3.510917779243718*^9, 3.510917795795347*^9}, 3.5114256263815365`*^9, {
   3.511425745238146*^9, 3.511425757047366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makewirepotc", "[", "w_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], 
       RowBox[{"w", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "w$kstr"}], "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"I", " ", 
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$slos"}], "]"}], "]"}]}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"norm", "[", 
           RowBox[{
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod1"}], "]"}], "]"}], ",", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos1"}], "]"}], "]"}]}], "]"}], "-", 
            "\[IndentingNewLine]", 
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod2"}], "]"}], "]"}], ",", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos2"}], "]"}], "]"}]}], "]"}]}], "]"}], 
          "-", 
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$nlen"}], "]"}], "]"}]}], ")"}], "2"]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "w", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.5109177646108923`*^9}, {3.510918867080429*^9, 3.5109188674860296`*^9}, 
   3.5114256263815365`*^9, {3.511425774534997*^9, 3.511425777202602*^9}, {
   3.52315428327229*^9, 3.523154290791503*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makewirepotc", "::", "usage"}], "=", 
    "\"\<makewirepotc[wirelist] calculates wire stretching potentials from \
'wirelist' with imaginary part.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.511426144146446*^9, 3.5114261954081364`*^9}, 
   3.5127237183744555`*^9, 3.529708119563531*^9}],

Cell[CellGroupData[{

Cell["\<\
Function to generate wire stretching potentials with imaginary part of spring \
constants.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109160605418997`*^9, 3.510916071430719*^9}, 
   3.510916159695674*^9, {3.510917709074795*^9, 3.510917713130802*^9}, {
   3.510917779243718*^9, 3.510917795795347*^9}, 3.5114256263815365`*^9, {
   3.511425745238146*^9, 3.511425757047366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makewirepotc2", "[", "w_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", 
          RowBox[{"n", ",", "w$kstr"}], "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"I", " ", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "w$blos"}], "]"}], "]"}]}]}], ")"}], 
        "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"norm", "[", 
            RowBox[{
             RowBox[{"b2s", "[", 
              RowBox[{
               RowBox[{"w", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "w$bod1"}], "]"}], "]"}], ",", 
               RowBox[{"w", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "w$pos1"}], "]"}], "]"}]}], "]"}], "-", 
             "\[IndentingNewLine]", 
             RowBox[{"b2s", "[", 
              RowBox[{
               RowBox[{"w", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "w$bod2"}], "]"}], "]"}], ",", 
               RowBox[{"w", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "w$pos2"}], "]"}], "]"}]}], "]"}]}], "]"}],
            "-", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "w$nlen"}], "]"}], "]"}]}], ")"}], "2"]}], 
       "\[IndentingNewLine]", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", 
          RowBox[{"n", ",", "w$kstr"}], "]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "w$slos"}], "]"}], "]"}]}], "-", 
          RowBox[{"I", " ", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "w$blos"}], "]"}], "]"}]}]}], ")"}], 
        "\[IndentingNewLine]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod1"}], "]"}], "]"}], ",", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos1"}], "]"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod2"}], "]"}], "]"}], ",", 
              RowBox[{"w", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos2"}], "]"}], "]"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "w$nlen"}], "]"}], "]"}]}], ")"}], "2"]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "w", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.5109177646108923`*^9}, {3.510918867080429*^9, 3.5109188674860296`*^9}, 
   3.5114256263815365`*^9, {3.511425774534997*^9, 3.511425777202602*^9}, {
   3.52315428327229*^9, 3.523154290791503*^9}, 3.523154444950974*^9, 
   3.523154591232431*^9, {3.523154657813348*^9, 3.5231548810809402`*^9}, {
   3.523154928941824*^9, 3.523154930611027*^9}, {3.523155702609583*^9, 
   3.523155722608818*^9}, {3.523178346560508*^9, 3.5231784062930126`*^9}, {
   3.5231790650041695`*^9, 3.5231791279658804`*^9}, {3.5231792807261496`*^9, 
   3.5231792824109526`*^9}, {3.5231798280219107`*^9, 3.523179829098313*^9}, {
   3.5231800248474565`*^9, 3.523180032975071*^9}, {3.523180160302494*^9, 
   3.5231801811441307`*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makewirepotc2", "::", "usage"}], "=", 
    "\"\<makewirepotc2[wirelist] calculates wire stretching potentials from \
'wirelist' with imaginary part.\nIn the calculation, the q-factors of the \
bending mode and the stretching mode are separately considered.\>\""}], ";"}],
   "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.511426144146446*^9, 3.5114261954081364`*^9}, 
   3.5127237183744555`*^9, {3.523154443094571*^9, 3.5231544799574356`*^9}, {
   3.523154554463166*^9, 3.523154566709188*^9}, 3.529708121954667*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Wire Torsion Potential", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114259545281134`*^9, 3.511425960955324*^9}}],

Cell[CellGroupData[{

Cell["Function to generate wire torsion potentials.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5110018339283285`*^9, 3.5110018478435535`*^9}, 
   3.5110031176389837`*^9, 3.5114262211637816`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"maketorsionpot", "[", "w_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], 
       RowBox[{"w", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "w$ktor"}], "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$bod1", ",", "5"}], "]"}], "]"}], "-", 
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$bod2", ",", "5"}], "]"}], "]"}]}], ")"}], 
        "2"]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "w", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.510917696625973*^9}, {3.510918860216417*^9, 3.510918860700018*^9}, {
   3.5110018832868156`*^9, 3.5110019794453845`*^9}, 3.511002077538357*^9, {
   3.5110031129433756`*^9, 3.5110031176389837`*^9}, 3.5114262211637816`*^9, {
   3.5231543669040365`*^9, 3.5231543756712523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"maketorsionpot", "::", "usage"}], "=", 
    "\"\<maketorsionpot[wirelist] calculates real part of wire torsion \
potentials from 'wirelist'.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511426211164164*^9, 3.5114262537522388`*^9}, 
   3.5127237318242245`*^9, 3.529708124337804*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Function to generate wire torsion potentials with imaginary part of spring \
constants.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109160605418997`*^9, 3.510916071430719*^9}, 
   3.510916159695674*^9, {3.510917709074795*^9, 3.510917713130802*^9}, {
   3.510917779243718*^9, 3.510917795795347*^9}, {3.511002021393858*^9, 
   3.5110020220802593`*^9}, {3.5110031129433756`*^9, 3.5110031176389837`*^9}, 
   3.5114259673357353`*^9, 3.5114262802722855`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"maketorsionpotc", "[", "w_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], 
       RowBox[{"w", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "w$ktor"}], "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"I", " ", 
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$tlos"}], "]"}], "]"}]}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$bod1", ",", "5"}], "]"}], "]"}], "-", 
          RowBox[{"w", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "w$bod2", ",", "5"}], "]"}], "]"}]}], ")"}], 
        "2"]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "w", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.5109177646108923`*^9}, {3.510918867080429*^9, 3.5109188674860296`*^9}, {
   3.5110020297086725`*^9, 3.5110020724059477`*^9}, {3.5110031129433756`*^9, 
   3.5110031176389837`*^9}, 3.5114259673357353`*^9, 3.5114262802722855`*^9, {
   3.5231543870748725`*^9, 3.523154405607705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"maketorsionpotc", "::", "usage"}], "=", 
    "\"\<maketorsionpotc[wirelist] calculates wire torsion potentials from \
'wirelist' with imaginary part.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114262278405933`*^9, 3.5114262802722855`*^9}, 
   3.5127237352434206`*^9, 3.5297081260539017`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Spirng Potential", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.51142594109649*^9, 3.511425944528496*^9}}],

Cell[CellGroupData[{

Cell["Function to generate spring potentials.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109160605418997`*^9, 3.510916071430719*^9}, 
   3.510916159695674*^9, {3.511132062793888*^9, 3.5111320635738897`*^9}, {
   3.5114259339672775`*^9, 3.5114259347316785`*^9}, 3.511426682998393*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makespringpot", "[", "s_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"deltapos", ",", "deltaang", ",", "mat", ",", "delta"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"deltapos", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"(*", " ", 
            RowBox[{"delta", " ", "of", " ", "position"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rotXYZ", "[", 
              RowBox[{"s", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "s$bod1", ",", 
                 RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b2s", "[", 
               RowBox[{
                RowBox[{"s", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "s$bod2"}], "]"}], "]"}], ",", 
                RowBox[{"s", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "s$pos2"}], "]"}], "]"}]}], "]"}], "-", 
              "\[IndentingNewLine]", 
              RowBox[{"b2s", "[", 
               RowBox[{
                RowBox[{"s", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "s$bod1"}], "]"}], "]"}], ",", 
                RowBox[{"s", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "s$pos1"}], "]"}], "]"}]}], "]"}]}], 
             ")"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mat", "=", 
          RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"rotXYZ", "[", 
              RowBox[{"s", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "s$bod2", ",", 
                 RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
            "\[IndentingNewLine]", 
            RowBox[{"rotXYZ", "[", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "s$bod1", ",", 
                RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"deltaang", "=", 
          RowBox[{"(*", " ", 
           RowBox[{"delta", " ", "of", " ", "angle"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"delta", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"deltapos", ",", "deltaang"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"delta", ".", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "s$kmat"}], "]"}], "]"}], ".", "delta"}]}], 
          "-", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "s$fvec"}], "]"}], "]"}], ".", "delta"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.510917696625973*^9}, {3.510918860216417*^9, 3.510918860700018*^9}, {
   3.5111320680822973`*^9, 3.511132070843502*^9}, {3.5111334783871746`*^9, 
   3.5111335587585154`*^9}, {3.511133590722972*^9, 3.511133619286622*^9}, {
   3.511133694284354*^9, 3.511133997673687*^9}, {3.5111340326645484`*^9, 
   3.5111340401681614`*^9}, {3.511134384226766*^9, 3.511134389593175*^9}, {
   3.5111394765905104`*^9, 3.511139485638526*^9}, {3.511139704865711*^9, 
   3.511139711058922*^9}, 3.5111397640678153`*^9, {3.5111398223807173`*^9, 
   3.511139837965145*^9}, 3.5111400347906904`*^9, {3.511140882199779*^9, 
   3.5111408914193954`*^9}, {3.5111409236022515`*^9, 
   3.5111409335238695`*^9}, {3.511426327852369*^9, 3.5114265050956807`*^9}, 
   3.51142654447015*^9, {3.511426583267418*^9, 3.5114265848274207`*^9}, 
   3.511426682998393*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makespringpot", "::", "usage"}], "=", 
    "\"\<makespringpot[springlist] calculates real part of spring potentials \
from 'springlist'.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511426211164164*^9, 3.5114262537522388`*^9}, {
   3.5114266052166567`*^9, 3.5114266231254883`*^9}, 3.5114267049164314`*^9, 
   3.5127237407817373`*^9, 3.5297081502812877`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Function to generate wire stretching potentials with imaginary part of spring \
constants.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109160605418997`*^9, 3.510916071430719*^9}, 
   3.510916159695674*^9, {3.510917709074795*^9, 3.510917713130802*^9}, {
   3.510917779243718*^9, 3.510917795795347*^9}, 3.5114266794571867`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makespringpotc", "[", "s_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"deltapos", ",", "deltaang", ",", "mat", ",", "delta"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"deltapos", "=", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"rotXYZ", "[", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "s$bod1", ",", 
                RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b2s", "[", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "s$bod2"}], "]"}], "]"}], ",", 
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "s$pos2"}], "]"}], "]"}]}], "]"}], "-", 
             "\[IndentingNewLine]", 
             RowBox[{"b2s", "[", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "s$bod1"}], "]"}], "]"}], ",", 
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "s$pos1"}], "]"}], "]"}]}], "]"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mat", "=", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"rotXYZ", "[", 
             RowBox[{"s", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "s$bod2", ",", 
                RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}], "]"}], ".", 
           "\[IndentingNewLine]", 
           RowBox[{"rotXYZ", "[", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "s$bod1", ",", 
               RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"deltaang", "=", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"delta", "=", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{"deltapos", ",", "deltaang"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"delta", ".", 
            RowBox[{"s", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "s$cmat"}], "]"}], "]"}], ".", "delta"}]}], 
          "-", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "s$fvec"}], "]"}], "]"}], ".", "delta"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.510916076734728*^9, 3.5109161193384027`*^9}, 
   3.510916159695674*^9, {3.5109162439826217`*^9, 3.510916452476988*^9}, {
   3.510916485611446*^9, 3.510916553019164*^9}, {3.510917692382766*^9, 
   3.5109177646108923`*^9}, {3.510918867080429*^9, 3.5109188674860296`*^9}, {
   3.5111344215108314`*^9, 3.511134459808899*^9}, {3.511139458198078*^9, 
   3.511139473704505*^9}, {3.511139655148424*^9, 3.5111396982044992`*^9}, {
   3.511140229229432*^9, 3.5111402332074394`*^9}, {3.5111409595915146`*^9, 
   3.511140970027933*^9}, {3.511426530040125*^9, 3.5114265710993967`*^9}, 
   3.5114266794571867`*^9, {3.512726903651241*^9, 3.51272690897085*^9}, {
   3.5223782374525776`*^9, 3.522378257093012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makespringpotc", "::", "usage"}], "=", 
    "\"\<makespringpotc[springlist] calculates spring potentials from \
'springlist' with imaginary part.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.511426211164164*^9, 3.5114262537522388`*^9}, {
   3.5114266052166567`*^9, 3.511426649208734*^9}, {3.5114266794571867`*^9, 
   3.5114267015000257`*^9}, {3.5127237443359404`*^9, 3.5127237456260147`*^9}, 
   3.529708152458412*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gravity Potential", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511425871925968*^9, 3.511425875716775*^9}}],

Cell[CellGroupData[{

Cell["Function to generate gravity potential of bodies", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510966434486368*^9, 3.510966454891204*^9}, 
   3.5109673975696597`*^9, 3.5114267174432535`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makegravpot", "[", "b_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{"b", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "b$mass"}], "]"}], "]"}], 
       RowBox[{"b", "[", 
        RowBox[{"[", 
         RowBox[{"n", ",", "b$pos", ",", "2"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510966457964409*^9, 3.510966540051753*^9}, {
   3.51096657218781*^9, 3.5109665732330112`*^9}, {3.510966793006198*^9, 
   3.510966796204203*^9}, 3.5109673975696597`*^9, 3.5114267174432535`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makegravpotc", "::", "usage"}], "=", 
    "\"\<makegravpot[springlist] calculates gravity potentials from \
'bodylist'.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511426211164164*^9, 3.5114262537522388`*^9}, {
   3.5114266052166567`*^9, 3.511426649208734*^9}, {3.5114266794571867`*^9, 
   3.5114267431208987`*^9}, 3.5127237476071277`*^9, 3.5297081543795223`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinetic Energy", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114259055752273`*^9, 3.5114259091944337`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Function to generate the angular velocity vector in body coordinates for use \
in the calculation of the kinetic energy.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510917099238524*^9, 3.510917123683767*^9}, 
   3.5109673807684298`*^9, 3.5114271546808214`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"omegaB", "[", 
     RowBox[{"{", 
      RowBox[{"pitch_", ",", "yaw_", ",", "roll_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"omegaIB", "[", 
      RowBox[{"{", 
       RowBox[{"pitch", ",", "yaw", ",", "roll"}], "}"}], "]"}], ".", 
     RowBox[{"timeD", "[", 
      RowBox[{"{", 
       RowBox[{"pitch", ",", "yaw", ",", "roll"}], "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510917132419782*^9, 3.510917194383091*^9}, {
   3.5109667467677164`*^9, 3.51096674901412*^9}, 3.5109673807684298`*^9, {
   3.511138570525319*^9, 3.5111385720073214`*^9}, {3.511139988567809*^9, 
   3.5111399902994127`*^9}, 3.5114271546964216`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"omegaB", "::", "usage"}], "=", 
    "\"\<omegaB[{pitch,yaw,roll}] generates the angular velocity vector in \
body coordinates for use in the calculation of the kinetic energy.\>\""}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511427104807534*^9, 3.5114271546964216`*^9}, {
   3.512723752628415*^9, 3.512723753281452*^9}, 3.529708156076619*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Function to generate kinetic energy of bodies", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109666056342688`*^9, 3.5109666173966894`*^9}, 
   3.5109674043088713`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makekinetic", "[", "b_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "b$mass"}], "]"}], "]"}], "\[Equal]", "0"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"(*", "then", "*)"}], "0", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "else", "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"b", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "b$mass"}], "]"}], "]"}], 
          RowBox[{"sqvec", "[", 
           RowBox[{"timeD", "[", 
            RowBox[{"b", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "b$pos", ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{
           RowBox[{"omegaB", "[", 
            RowBox[{"b", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "b$pos", ",", 
               RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}], ".", 
           RowBox[{"b", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "b$moi"}], "]"}], "]"}], ".", 
           RowBox[{"omegaB", "[", 
            RowBox[{"b", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "b$pos", ",", 
               RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.510966620079894*^9, 3.510966707393247*^9}, {
   3.5109668038170166`*^9, 3.510966926183632*^9}, {3.510967019050595*^9, 
   3.510967024760205*^9}, 3.5109674043088713`*^9, {3.5111386171226006`*^9, 
   3.5111386287446213`*^9}, {3.511328534569358*^9, 3.5113286008850737`*^9}, {
   3.511427238031768*^9, 3.5114273113830967`*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makekinetic", "::", "usage"}], "=", 
   "\"\<makekinetic[bodylist] calculates kinetic energy of bodies from \
bodylist.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.511427163931638*^9, 3.511427214101326*^9}, {
   3.5127237560796123`*^9, 3.512723756652645*^9}, 3.5297081577277136`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Damping Energy", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511427097678322*^9, 3.5114270996907253`*^9}}],

Cell[CellGroupData[{

Cell["Function to generate damping energy.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109666056342688`*^9, 3.5109666173966894`*^9}, 
   3.5109674043088713`*^9, {3.5113887398438873`*^9, 3.5113887485799026`*^9}, {
   3.5114273500399647`*^9, 3.5114273513347673`*^9}, 3.5114274042656603`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makedamping", "[", "d_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "deltavec", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "d", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"deltavec", "=", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"timeD", "[", 
                RowBox[{"b2s", "[", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "d$bod1"}], "]"}], "]"}], ",", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "d$pos1"}], "]"}], "]"}]}], "]"}], 
                "]"}], ",", 
               RowBox[{"omegaB", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "d$bod1", ",", 
                   RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}]}], "]"}], 
             "-", "\[IndentingNewLine]", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"timeD", "[", 
                RowBox[{"b2s", "[", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "d$bod2"}], "]"}], "]"}], ",", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "d$pos2"}], "]"}], "]"}]}], "]"}], 
                "]"}], ",", 
               RowBox[{"omegaB", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "d$bod2", ",", 
                   RowBox[{"4", ";;", "6"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], 
            RowBox[{"deltavec", ".", 
             RowBox[{"d", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "d$dmat"}], "]"}], "]"}], ".", 
             "deltavec"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "d", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510966620079894*^9, 3.510966707393247*^9}, {
   3.5109668038170166`*^9, 3.510966926183632*^9}, {3.510967019050595*^9, 
   3.510967024760205*^9}, 3.5109674043088713`*^9, {3.5111386171226006`*^9, 
   3.5111386287446213`*^9}, {3.511328534569358*^9, 3.5113286008850737`*^9}, 
   3.5113887398438873`*^9, {3.5113887709659424`*^9, 3.5113889226918087`*^9}, {
   3.5113889658102846`*^9, 3.5113890006919456`*^9}, {3.5113893511933613`*^9, 
   3.5113893569185715`*^9}, {3.5113901301495295`*^9, 3.511390165202791*^9}, 
   3.5114274042656603`*^9, 3.5225460318873825`*^9, {3.5225460948646927`*^9, 
   3.522546183270048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makedamping", "::", "usage"}], "=", 
    "\"\<makedamping[damperlist] calculates damping energy or the system from \
damperlist\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114273555467744`*^9, 3.5114274042656603`*^9}, 
   3.5127237650081224`*^9, 3.52970816186695*^9}]
}, Closed]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy Calculation [Newly Added in SUMCON]", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.571490596378203*^9, 3.571490606455779*^9}}],

Cell[CellGroupData[{

Cell["kinetic spring", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5708941913851457`*^9, 3.5708941946213303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makekineticvspr", "[", "spr_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"spr", "[", 
         RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
       RowBox[{"spr", "\[Equal]", 
        RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"spr", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "5"}], "]"}], "]"}], "]"}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"spr", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "6"}], "]"}], "]"}], "/", "20"}], ")"}]}], 
           "*", 
           RowBox[{
            RowBox[{"spr", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "4"}], "]"}], "]"}], "/", "g"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<vy\>\"", "<>", 
             RowBox[{"save$bdn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"save$wire", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"spr", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                 "]"}], ",", "2"}], "]"}], "]"}]}], "]"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"\"\<vy\>\"", "<>", 
             RowBox[{"save$bdn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"save$wire", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"spr", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                 "]"}], ",", "2"}], "]"}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "spr", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5708941960534124`*^9, 3.57089436420903*^9}, {
  3.570894754113332*^9, 3.5708948192900596`*^9}, {3.5708948718580666`*^9, 
  3.5708949752889824`*^9}, {3.5712199562521234`*^9, 3.571219956663147*^9}, {
  3.5714929475346813`*^9, 3.571492952015938*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["kinetic IP", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5708941913851457`*^9, 3.5708941946213303`*^9}, {
  3.571070736918579*^9, 3.571070737079588*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makekineticIP", "[", "ip_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ip", "[", 
         RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
       RowBox[{"ip", "===", 
        RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"ip", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "11"}], "]"}], "]"}], "]"}], ",", "0", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ip", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "9"}], "]"}], "]"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"+", "1"}]}], "]"}], "*", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ip", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "8"}], "]"}], "]"}], "/", "20"}], ")"}]}], 
           "*", 
           RowBox[{
            RowBox[{"ip", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "10"}], "]"}], "]"}], "/", "3"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"timeD", "[", 
             RowBox[{"b2s", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"save$bodypos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ip", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                  "]"}], ",", "0", ",", 
                 RowBox[{"save$bodypos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ip", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                  "]"}], ",", "\[IndentingNewLine]", "0", ",", 
                 RowBox[{"save$bodypos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ip", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], 
                  "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ip", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
                 ",", "0", ",", 
                 RowBox[{"ip", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}], ".", "\[IndentingNewLine]", 
            RowBox[{"timeD", "[", 
             RowBox[{"b2s", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"save$bodypos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ip", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                  "]"}], ",", "0", ",", 
                 RowBox[{"save$bodypos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ip", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                  "]"}], ",", "\[IndentingNewLine]", "0", ",", 
                 RowBox[{"save$bodypos", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ip", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                  "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ip", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
                 ",", "0", ",", 
                 RowBox[{"ip", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}]}]}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "ip", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5708941960534124`*^9, 3.57089436420903*^9}, {
  3.570894754113332*^9, 3.5708948192900596`*^9}, {3.5708948718580666`*^9, 
  3.5708949752889824`*^9}, {3.5710707401767654`*^9, 3.5710707924257536`*^9}, {
  3.571070882467904*^9, 3.5710708826449137`*^9}, {3.57107091404171*^9, 
  3.5710709249643345`*^9}, {3.5710710224889126`*^9, 3.571071037169752*^9}, {
  3.5710710712497015`*^9, 3.5710711623999147`*^9}, {3.5714929228842716`*^9, 
  3.5714929315527673`*^9}, {3.5716789669202766`*^9, 3.5716789805140543`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["V Spring Pot", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5708714831439247`*^9, 3.570871491084379*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makevsprpot", "[", "spr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"spr", "[", 
        RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
      RowBox[{"spr", "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"spr", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{
          RowBox[{"allfloats", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "^", "2"}]}], "-", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"spr", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"allfloats", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "spr", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5708714933685093`*^9, 3.5708715594802914`*^9}, {
  3.570871623847973*^9, 3.5708716606950803`*^9}, {3.5708717186903973`*^9, 
  3.5708717345313034`*^9}, {3.570871780018905*^9, 3.5708718161399713`*^9}, {
  3.5708718637896967`*^9, 3.570871882543769*^9}, {3.5708932895635643`*^9, 
  3.5708932934197845`*^9}, {3.57149295921935*^9, 3.571492962296526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makevsprpotc", "[", "spr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"spr", "[", 
        RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
      RowBox[{"spr", "\[Equal]", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"spr", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "3"}], "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"I", "/", 
            RowBox[{"spr", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "9"}], "]"}], "]"}]}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"allfloats", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "^", "2"}]}], "-", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"spr", "[", 
          RowBox[{"[", 
           RowBox[{"n", ",", "4"}], "]"}], "]"}], "*", 
         RowBox[{"allfloats", "[", 
          RowBox[{"[", "n", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "spr", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57089322655696*^9, 3.5708932678183203`*^9}, 
   3.570893298372068*^9, {3.571074098770866*^9, 3.571074099120886*^9}, {
   3.571492964341643*^9, 3.5714929683958745`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["IP Pot", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5708718333449554`*^9, 3.570871837783209*^9}, {
  3.5710691700049562`*^9, 3.5710691711750236`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeIPpot", "[", "ip_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ip", "[", 
        RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
      RowBox[{"ip", "===", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ip", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "4", ",", "m"}], "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"ip", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "10"}], "]"}], "]"}], "*", 
            RowBox[{
             RowBox[{"g", "/", 
              RowBox[{"ip", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "7"}], "]"}], "]"}]}], "/", "3"}]}]}], 
          ")"}], "*", "\[IndentingNewLine]", 
         RowBox[{"sqvec", "[", 
          RowBox[{
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "-", "\[IndentingNewLine]", 
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "6"}], "]"}], 
                "]"}]}], ",", "0", ",", 
              RowBox[{"save$bodypos", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"ip", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "4"}], "]"}], 
               "]"}]}], "}"}], "*", 
            RowBox[{"ip", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "7"}], "]"}], "]"}]}]}], "]"}]}], "-", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ip", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "10"}], "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"g", "/", 
             RowBox[{"ip", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "7"}], "]"}], "]"}]}], "/", "3"}]}], ")"}], 
         "*", "\[IndentingNewLine]", 
         RowBox[{"sqvec", "[", 
          RowBox[{
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "-", "\[IndentingNewLine]", 
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "ip", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5708718402193484`*^9, 3.5708718506129427`*^9}, {
   3.5708718897491817`*^9, 3.5708719129535084`*^9}, {3.5708720946549015`*^9, 
   3.570872195480668*^9}, {3.5708933018752685`*^9, 3.5708933063725257`*^9}, {
   3.570893468229783*^9, 3.570893472855048*^9}, {3.5710691780134144`*^9, 
   3.5710692082161417`*^9}, {3.571070245196454*^9, 3.5710702474095807`*^9}, {
   3.5710703680954833`*^9, 3.571070369818582*^9}, {3.5710704115409684`*^9, 
   3.5710706840735564`*^9}, {3.57107098013649*^9, 3.571071014213439*^9}, {
   3.571071308878293*^9, 3.571071401466589*^9}, 3.571071432031337*^9, {
   3.571255550133977*^9, 3.5712555972886744`*^9}, {3.5712558776497097`*^9, 
   3.571255879365808*^9}, {3.5712559729161587`*^9, 3.571256017985737*^9}, {
   3.571256060148148*^9, 3.57125606035616*^9}, {3.5712561413687935`*^9, 
   3.5712562088106513`*^9}, {3.571256278714649*^9, 3.571256307062271*^9}, {
   3.571492978709464*^9, 3.571492982665691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeIPpotc", "[", "ip_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ip", "[", 
        RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
      RowBox[{"ip", "===", 
       RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ip", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "4", ",", "m"}], "]"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"I", "/", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "5", ",", "m"}], "]"}], "]"}]}]}], ")"}]}],
            "+", 
           RowBox[{
            RowBox[{"ip", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "10"}], "]"}], "]"}], "*", 
            RowBox[{
             RowBox[{"g", "/", 
              RowBox[{"ip", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "7"}], "]"}], "]"}]}], "/", "3"}]}]}], 
          ")"}], "*", "\[IndentingNewLine]", 
         RowBox[{"sqvec", "[", 
          RowBox[{
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "-", "\[IndentingNewLine]", 
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "6"}], "]"}], 
                "]"}]}], ",", "0", ",", 
              RowBox[{"save$bodypos", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"ip", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "4"}], "]"}], 
               "]"}]}], "}"}], "*", 
            RowBox[{"ip", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "7"}], "]"}], "]"}]}]}], "]"}]}], "-", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ip", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "10"}], "]"}], "]"}], "*", 
           RowBox[{
            RowBox[{"g", "/", 
             RowBox[{"ip", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "7"}], "]"}], "]"}]}], "/", "3"}]}], ")"}], 
         "*", "\[IndentingNewLine]", 
         RowBox[{"sqvec", "[", 
          RowBox[{
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "-", "\[IndentingNewLine]", 
           RowBox[{"b2s", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                "]"}], ",", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                "]"}], ",", "\[IndentingNewLine]", "0", ",", 
               RowBox[{"save$bodypos", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                "]"}], ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "1"}], "]"}], "]"}], 
               ",", "0", ",", 
               RowBox[{"ip", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3", ",", "m", ",", "2"}], "]"}], "]"}]}], 
              "}"}]}], "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "ip", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.570893331651972*^9, 3.570893436291957*^9}, {
   3.571070699125417*^9, 3.5710707221877365`*^9}, {3.5710709394331617`*^9, 
   3.571070974799185*^9}, {3.5710714115131636`*^9, 3.571071428922159*^9}, {
   3.571072704960144*^9, 3.5710727262873645`*^9}, {3.5712556207030134`*^9, 
   3.5712556283454504`*^9}, 3.5712562223384247`*^9, {3.571256314594702*^9, 
   3.57125633047661*^9}, {3.571493580873906*^9, 3.571493585567175*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["HL Pot", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.570872216195853*^9, 3.5708722179729548`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeHLpotc", "[", "HL_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"HL", "[", 
         RowBox[{"[", "0", "]"}], "]"}], "=!=", "List"}], "||", 
       RowBox[{"HL", "\[Equal]", 
        RowBox[{"{", "}"}]}]}], ",", "0", ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"b2s", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"bodylist", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1", ",", 
                    "m"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "6"}], "}"}]}], "]"}], ",", 
                RowBox[{"HL", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"bodylist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1", ",", 
                   "m"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "4", ",", "6"}], "}"}]}], "]"}]}], "]"}], 
            "-", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"b2s", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"bodylist", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
                    "m"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "6"}], "}"}]}], "]"}], ",", 
                RowBox[{"HL", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"bodylist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
                   "m"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "4", ",", "6"}], "}"}]}], "]"}]}], "]"}], 
            "+", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"HL", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "5", ",", "1"}], "]"}], "]"}], ",", "0", 
              ",", 
              RowBox[{"HL", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "5", ",", "3"}], "]"}], "]"}], ",", "0", 
              ",", "0", ",", "0"}], "}"}]}], ")"}], ".", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"HL", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "9", ",", "m", ",", "l"}], "]"}], "]"}], 
               "\[Equal]", "\"\<\>\""}], ",", 
              RowBox[{
               RowBox[{"HL", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "8", ",", "m", ",", "l"}], "]"}], "]"}], 
               "*", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"I", "/", 
                  RowBox[{"HL", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "7"}], "]"}], "]"}]}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"\"\<kHL$\>\"", "<>", 
                RowBox[{"HL", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "9", ",", "m", ",", "l"}], "]"}], "]"}]}],
                "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "6"}], "}"}]}], "]"}], ".", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"b2s", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"bodylist", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1", ",", 
                    "m"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "6"}], "}"}]}], "]"}], ",", 
                RowBox[{"HL", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"bodylist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "1", ",", 
                   "m"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "4", ",", "6"}], "}"}]}], "]"}]}], "]"}], 
            "-", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"b2s", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"bodylist", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
                    "m"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "6"}], "}"}]}], "]"}], ",", 
                RowBox[{"HL", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"bodylist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"HL", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "1", ",", 
                   "m"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "4", ",", "6"}], "}"}]}], "]"}]}], "]"}], 
            "+", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"HL", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "5", ",", "1"}], "]"}], "]"}], ",", "0", 
              ",", 
              RowBox[{"HL", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "5", ",", "3"}], "]"}], "]"}], ",", "0", 
              ",", "0", ",", "0"}], "}"}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "HL", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5708722281025343`*^9, 3.570872280269518*^9}, {
   3.5708723297293468`*^9, 3.570872424156748*^9}, {3.5708724579716816`*^9, 
   3.5708725112667303`*^9}, {3.570872570951144*^9, 3.570872625295252*^9}, {
   3.570891728722289*^9, 3.570891800449392*^9}, {3.570891903079262*^9, 
   3.5708919038103037`*^9}, 3.570892025418259*^9, {3.5708920776472464`*^9, 
   3.570892209719801*^9}, {3.570892651829088*^9, 3.570892689941268*^9}, {
   3.5708928322664084`*^9, 3.5708928631751766`*^9}, {3.5708929450718603`*^9, 
   3.5708930043272495`*^9}, {3.570893120737908*^9, 3.5708931381879063`*^9}, {
   3.570893600282336*^9, 3.570893616148244*^9}, {3.5708936494921513`*^9, 
   3.570893676735709*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equation of Motion", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5296499364624443`*^9, 3.5296499390520487`*^9}}],

Cell[CellGroupData[{

Cell["Make Matrix", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.510919377903326*^9, 3.5109193807893314`*^9}, 
   3.510919878399005*^9, 3.51092176588993*^9, {3.5114276469864864`*^9, 
   3.5114276505900927`*^9}, {3.529649958536483*^9, 3.529649962108889*^9}}],

Cell["\<\
Differentiate energy terms by two variable sets, and generate linearized \
equation of motion matrices.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510641909010005*^9, 3.5106419141892138`*^9}, {
   3.5106426198252535`*^9, 3.510642620948455*^9}, {3.5106433173024783`*^9, 
   3.5106433212336855`*^9}, {3.510919409025381*^9, 3.510919412816188*^9}, {
   3.5109195437160177`*^9, 3.51091955089203*^9}, 3.5109196334473753`*^9, {
   3.5109196785470543`*^9, 3.5109197488407774`*^9}, 3.510919878399005*^9, {
   3.51092176588993*^9, 3.5109217730583396`*^9}, {3.5109555688568163`*^9, 
   3.5109555835966597`*^9}, {3.5114276758309374`*^9, 
   3.5114276772349396`*^9}, {3.529649971531306*^9, 3.529649998737754*^9}, {
   3.5296500706558833`*^9, 3.529650180792077*^9}, {3.529650230587364*^9, 
   3.529650263534622*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makemat", "[", 
     RowBox[{"eng_", ",", "var1_List", ",", "var2_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Chop", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"eng", ",", 
           RowBox[{"var1", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"var2", "[", 
            RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "var1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"Length", "[", "var2", "]"}]}], "}"}]}], "]"}], "/.", 
       "subminvars"}], "/.", "subdefparams"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106419181204205`*^9, 3.5106420089749804`*^9}, {
   3.510642051843856*^9, 3.5106420537938595`*^9}, {3.5106420927627277`*^9, 
   3.510642096522334*^9}, {3.5106421701232634`*^9, 3.510642454028162*^9}, {
   3.510642501405445*^9, 3.5106425019514465`*^9}, 3.510642539843913*^9, {
   3.5106426112452383`*^9, 3.5106426126492405`*^9}, {3.510643462897534*^9, 
   3.510643465799139*^9}, {3.510829640153338*^9, 3.5108297342995033`*^9}, 
   3.5108303050823064`*^9, 3.5108303604936037`*^9, {3.510830541641122*^9, 
   3.510830566320365*^9}, {3.5108307431154757`*^9, 3.510830746890682*^9}, {
   3.5109197801656327`*^9, 3.510919897649439*^9}, {3.51092176588993*^9, 
   3.5109217730583396`*^9}, {3.511427839444024*^9, 3.5114278421740294`*^9}, {
   3.529650195674503*^9, 3.5296502273425584`*^9}, 3.5296502712878356`*^9, {
   3.5296503328923435`*^9, 3.52965043909733*^9}, {3.5296504964586315`*^9, 
   3.5296505131662607`*^9}, {3.529650760577894*^9, 3.5296507693919096`*^9}, {
   3.529651708646755*^9, 3.5296518252881603`*^9}, {3.529651983612838*^9, 
   3.5296521483959274`*^9}, {3.529652190406801*^9, 3.5296522684849386`*^9}, {
   3.5296523668539114`*^9, 3.5296526930504847`*^9}, {3.529652809253487*^9, 
   3.529652851591962*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makemat", "::", "usage"}], "=", 
    "\"\<makemat[eng,var1,var2] differentiate the energy term by two variable \
sets (var1,var2)\nand do substitution.\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.51142768896616*^9, 3.511427839444024*^9}, {
   3.5127237690723553`*^9, 3.5127237697373934`*^9}, {3.5296504638077736`*^9, 
   3.529650485616612*^9}, {3.5296505335350957`*^9, 3.5296506675237308`*^9}, {
   3.5296507786739264`*^9, 3.529650779625528*^9}, {3.5296520311617217`*^9, 
   3.5296520425029416`*^9}, 3.5297081636200504`*^9}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigen Mode", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5114276252400484`*^9, 3.511427627470852*^9}}],

Cell[CellGroupData[{

Cell["Eigen Mode List up", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.510919377903326*^9, 3.5109193807893314`*^9}, 
   3.510919878399005*^9, 3.51092176588993*^9, {3.5114276469864864`*^9, 
   3.5114276505900927`*^9}}],

Cell[CellGroupData[{

Cell["\<\
List variables whose amplitude of the eigen vector is larger than EPS.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510641909010005*^9, 3.5106419141892138`*^9}, {
   3.5106426198252535`*^9, 3.510642620948455*^9}, {3.5106433173024783`*^9, 
   3.5106433212336855`*^9}, {3.510919409025381*^9, 3.510919412816188*^9}, {
   3.5109195437160177`*^9, 3.51091955089203*^9}, 3.5109196334473753`*^9, {
   3.5109196785470543`*^9, 3.5109197488407774`*^9}, 3.510919878399005*^9, {
   3.51092176588993*^9, 3.5109217730583396`*^9}, {3.5109555688568163`*^9, 
   3.5109555835966597`*^9}, {3.5114276758309374`*^9, 3.5114276772349396`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"important", "[", 
     RowBox[{"eVec_List", ",", "eps_Real"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dummy", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dummy", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"eVec", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "]"}], ">", "eps"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"dummy", ",", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"allvars", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}], "<>", "\"\<(\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{
                 RowBox[{"eVec", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], ",", "0.01"}], "]"}], "]"}],
               "<>", "\"\<)\>\""}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "dummy"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106419181204205`*^9, 3.5106420089749804`*^9}, {
   3.510642051843856*^9, 3.5106420537938595`*^9}, {3.5106420927627277`*^9, 
   3.510642096522334*^9}, {3.5106421701232634`*^9, 3.510642454028162*^9}, {
   3.510642501405445*^9, 3.5106425019514465`*^9}, 3.510642539843913*^9, {
   3.5106426112452383`*^9, 3.5106426126492405`*^9}, {3.510643462897534*^9, 
   3.510643465799139*^9}, {3.510829640153338*^9, 3.5108297342995033`*^9}, 
   3.5108303050823064`*^9, 3.5108303604936037`*^9, {3.510830541641122*^9, 
   3.510830566320365*^9}, {3.5108307431154757`*^9, 3.510830746890682*^9}, {
   3.5109197801656327`*^9, 3.510919897649439*^9}, {3.51092176588993*^9, 
   3.5109217730583396`*^9}, {3.511427839444024*^9, 3.5114278421740294`*^9}, {
   3.529670388898629*^9, 3.52967040067665*^9}, 3.5297199245714264`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"important", "[", "eVec_List", "]"}], ":=", 
    RowBox[{"important", "[", 
     RowBox[{"eVec", ",", "0.3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106433885946035`*^9, 3.510643412649846*^9}, {
   3.510919878399005*^9, 3.5109198949350348`*^9}, 3.5109203589890494`*^9, {
   3.51092176588993*^9, 3.5109217730583396`*^9}, 3.511427839444024*^9, 
   3.5297199245714264`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"important", "::", "usage"}], "=", 
    "\"\<important[eVec,eps] makes a list of variables whose amplitude of the \
input eigen vector is larger than 'eps'. The default values of 'eps' is \
0.3.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.51142768896616*^9, 3.511427839444024*^9}, {
   3.5127237690723553`*^9, 3.5127237697373934`*^9}, 3.529708166355207*^9, 
   3.5297199245714264`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
List up eigen frequencies and types of eigen modes in TableForm\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.510919905636653*^9, 3.5109199235922847`*^9}, {
   3.510920013354842*^9, 3.5109201244738374`*^9}, {3.5109203817806892`*^9, 
   3.5109203902983046`*^9}, {3.510955597469453*^9, 3.5109555981284904`*^9}, {
   3.5114278553560524`*^9, 3.5114278568848553`*^9}, 3.5114282382275248`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF_List", ",", "eV_List", ",", "eps_Real", ",", "num_Integer"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<N\>\"", ",", "\"\<Freq\>\"", ",", "\"\<Type\>\""}], 
        "}"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "n", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"eF", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "}"}], ",", 
          RowBox[{"important", "[", 
           RowBox[{
            RowBox[{"eV", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", "eps"}], "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Length", "[", "allvars", "]"}], ",", "num"}], "]"}]}], 
         "}"}]}], "]"}]}], "]"}], "//", "TableForm"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.510642565303158*^9, 3.5106425659895587`*^9}, {
   3.5106426366108828`*^9, 3.5106426446448965`*^9}, {3.51064274910268*^9, 
   3.5106428142951946`*^9}, {3.5106429562710443`*^9, 
   3.5106431781814337`*^9}, {3.5106432486467576`*^9, 
   3.5106432656507874`*^9}, {3.510643326241294*^9, 3.5106433286124983`*^9}, 
   3.5106433666297646`*^9, 3.510643822212965*^9, {3.5109199507675323`*^9, 
   3.510919994603609*^9}, {3.510920147390278*^9, 3.5109201940499597`*^9}, 
   3.5109203817806892`*^9, {3.5114280854720564`*^9, 3.5114281150965085`*^9}, 
   3.5114282382275248`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF_List", ",", "eV_List", ",", "num_Integer"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF", ",", "eV", ",", "0.3", ",", "num"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106433308901024`*^9, 3.510643332122504*^9}, 
   3.5106433677841673`*^9, 3.510643823429767*^9, {3.5109201406354656`*^9, 
   3.510920144176672*^9}, {3.510920210679589*^9, 3.5109202453272495`*^9}, {
   3.5109202937341347`*^9, 3.5109203817806892`*^9}, 3.511428118138514*^9, {
   3.511428213938282*^9, 3.5114282382275248`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF_List", ",", "eV_List", ",", "eps_Real"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF", ",", "eV", ",", "eps", ",", 
     RowBox[{"Length", "[", "allvars", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109202514268603`*^9, 3.5109203363690095`*^9}, 
   3.5109203817806892`*^9, 3.5114281189341154`*^9, {3.5114282156074853`*^9, 
   3.5114282382275248`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF_List", ",", "eV_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"eigenmodetable", "[", 
    RowBox[{"eF", ",", "eV", ",", "0.3", ",", 
     RowBox[{"Length", "[", "allvars", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.510920282205714*^9, 3.5109202903489285`*^9}, {
  3.510920321860984*^9, 3.5109203817806892`*^9}, {3.511428119714117*^9, 
  3.5114281235361233`*^9}, {3.511428217869489*^9, 3.5114282382275248`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eigenmodetable", "::", "usage"}], "=", 
    "\"\<eigenmodetable[eF,eV,eps,num] shows a table of the eigen modes. \
'eps' is a cutoff amplitude which is used for picking up important variables. \
'num' sets a maximum number of the eigen modes that shown in the \
table.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114278620952644`*^9, 3.5114280614948144`*^9}, {
   3.5114281357041445`*^9, 3.511428174002212*^9}, 3.5114282382275248`*^9, {
   3.5127237737546234`*^9, 3.5127237761597605`*^9}, 3.5297081681363087`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigen Mode Plot", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5109210983055477`*^9, 3.510921112719973*^9}, {
  3.511427654349699*^9, 3.5114276576257052`*^9}}],

Cell[CellGroupData[{

Cell["Substitution", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511428502257989*^9, 3.5114285043795924`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Substitution that maps the variables to (equilibrium points + eigen vectors)\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.510823062404583*^9, 3.5108230651657877`*^9}, {
   3.510920510122115*^9, 3.510920562553807*^9}, {3.5109206700223956`*^9, 
   3.510920685544423*^9}, {3.511428263359169*^9, 3.511428264529171*^9}, 
   3.5114284360670724`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eigensub", "[", "eV_List", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sub", ",", "minf"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"allvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", 
           RowBox[{
            RowBox[{"eV", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"allvars", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "/.", "subminvars"}], 
             ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "allfloats", "]"}], "\[GreaterEqual]", "1"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"minf", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Inverse", "[", "matKff", "]"}], ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"Transpose", "[", "matKfv", "]"}], ".", 
                  "allvars"}]}], "-", 
                RowBox[{
                 RowBox[{"Transpose", "[", "matKfp", "]"}], ".", 
                 "allparams"}]}], ")"}]}], "/.", "\[IndentingNewLine]", 
             RowBox[{"makesub", "[", 
              RowBox[{"allvars", ",", "eV"}], "]"}]}], "/.", 
            "subdefparams"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{"sub", ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"allfloats", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", 
               RowBox[{
                RowBox[{"minf", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "+", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"allfloats", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "/.", "subminvars"}], 
                 ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "[", "allfloats", "]"}]}], "}"}]}], "]"}]}],
            "\[IndentingNewLine]", "]"}]}], ",", "sub"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5108251559906607`*^9, 3.510825215613965*^9}, {
   3.5108254249819326`*^9, 3.510825427977138*^9}, {3.5109204845224695`*^9, 
   3.510920502119301*^9}, {3.5109205774518332`*^9, 3.510920579729437*^9}, 
   3.510920685544423*^9, {3.511144108040245*^9, 3.511144260608513*^9}, {
   3.511144326378229*^9, 3.511144341962656*^9}, {3.511144578115871*^9, 
   3.5111448545795565`*^9}, {3.511144925700082*^9, 3.5111449800505767`*^9}, {
   3.5111450406878834`*^9, 3.5111450658039274`*^9}, {3.5111450976123834`*^9, 
   3.511145124990432*^9}, {3.5111455216523285`*^9, 3.511145569965613*^9}, {
   3.511151162825036*^9, 3.511151207487915*^9}, {3.511428336757298*^9, 
   3.5114283565381327`*^9}, 3.5114284360670724`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eigensub", "::", "usage"}], "=", 
    "\"\<eigensub[eVec] generates a substitution that maps the variables to \
(equilibrium points + eigen vectors 'eVec').\>\""}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114282524235497`*^9, 3.511428333278492*^9}, 
   3.5114284360670724`*^9, {3.51272378278714*^9, 3.51272378331217*^9}, 
   3.5297081702614307`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot Objects", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114286191645937`*^9, 3.511428661347068*^9}}],

Cell[CellGroupData[{

Cell["Plot markers, which define plot range", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109212978142986`*^9, 3.510921360167608*^9}, 
   3.510921489320235*^9, 3.5109216597058563`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"markerplot", "[", 
     RowBox[{"maxx_", ",", "maxz_", ",", "ytop_", ",", "ybottom_"}], "]"}], ":=",
     " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"+", "maxx"}], "/", "2"}], ",", "ytop", ",", 
          RowBox[{
           RowBox[{"+", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "maxx"}], "/", "2"}], ",", "ytop", ",", 
          RowBox[{
           RowBox[{"+", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"+", "maxx"}], "/", "2"}], ",", "ytop", ",", 
          RowBox[{
           RowBox[{"-", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "maxx"}], "/", "2"}], ",", "ytop", ",", 
          RowBox[{
           RowBox[{"-", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"+", "maxx"}], "/", "2"}], ",", "ybottom", ",", 
          RowBox[{
           RowBox[{"+", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "maxx"}], "/", "2"}], ",", "ybottom", ",", 
          RowBox[{
           RowBox[{"+", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"+", "maxx"}], "/", "2"}], ",", "ybottom", ",", 
          RowBox[{
           RowBox[{"-", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "maxx"}], "/", "2"}], ",", "ybottom", ",", 
          RowBox[{
           RowBox[{"-", "maxz"}], "/", "2"}]}], "}"}], "]"}], "]"}]}], "\n", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5108272121494737`*^9, 3.510827269229974*^9}, {
   3.510827387337781*^9, 3.5108275428856544`*^9}, {3.5109207530769415`*^9, 
   3.5109207685053687`*^9}, {3.5109209732245283`*^9, 3.510921005079784*^9}, 
   3.5109210598826804`*^9, 3.510921371181227*^9, 3.5109216597058563`*^9, {
   3.510921833355788*^9, 3.510921838363075*^9}, {3.510995418260763*^9, 
   3.510995434103669*^9}, 3.5116721997772617`*^9, {3.5123640830489717`*^9, 
   3.512364109927819*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot wires", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.510921467277396*^9, 3.510921472893406*^9}, 
   3.5109216665702486`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wireplot", "[", "sub_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"wirelist", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod1"}], "]"}], "]"}], ",", 
              RowBox[{"wirelist", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos1"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"b2s", "[", 
             RowBox[{
              RowBox[{"wirelist", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$bod2"}], "]"}], "]"}], ",", 
              RowBox[{"wirelist", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "w$pos2"}], "]"}], "]"}]}], "]"}]}], "}"}], 
          "]"}], "/.", "subdefparams"}], "/.", "sub"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "wirelist", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.5108254695512114`*^9, 3.510825546974147*^9}, {
   3.5108255774254007`*^9, 3.510825668701161*^9}, {3.510825704113223*^9, 
   3.510825705189625*^9}, {3.510825739540885*^9, 3.5108258221274304`*^9}, 
   3.5108281561851315`*^9, {3.5108283304374375`*^9, 3.510828350109072*^9}, {
   3.5109207950878153`*^9, 3.5109207955246162`*^9}, {3.510920831342279*^9, 
   3.5109209663761163`*^9}, {3.5109214396653476`*^9, 3.5109214529253707`*^9}, 
   3.5109214974790487`*^9, 3.5109216665702486`*^9, {3.510922002644471*^9, 
   3.5109220111649585`*^9}, 3.511152073679436*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot Bodies", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.510921501067055*^9, 3.510921513968278*^9}, 
   3.5109216695374184`*^9, {3.510997564713211*^9, 3.5109975654776125`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bodyplot", "[", "sub_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"list$BodyShape", ",", 
           RowBox[{"bodylist", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "b$shape"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", 
         RowBox[{"Point", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"bodylist", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "b$pos", ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "/.", "sub"}], "/.", 
           "subdefparams"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Rotate", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Rotate", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Rotate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mod$Create3DShape", "[", 
                  RowBox[{
                   RowBox[{"bodylist", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "b$pos", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"bodylist", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "b$shape"}], "]"}], "]"}], ",", 
                   RowBox[{"bodylist", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "b$size"}], "]"}], "]"}]}], "]"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"bodylist", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "b$pos", ",", "4"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                 RowBox[{"bodylist", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "b$pos", ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"bodylist", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "b$pos", ",", "5"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
               RowBox[{"bodylist", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "b$pos", ",", 
                  RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"bodylist", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "b$pos", ",", "6"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"bodylist", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "b$pos", ",", 
                RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "/.", "sub"}], "/.", 
          "subdefparams"}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"Length", "[", "bodylist", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.5108258335466504`*^9, 3.510825851861082*^9}, {
   3.510825889067148*^9, 3.510825892265154*^9}, {3.510827303347234*^9, 
   3.510827370271351*^9}, {3.510827758010032*^9, 3.5108277661064463`*^9}, {
   3.51082787658584*^9, 3.510827959312786*^9}, {3.510828000980459*^9, 
   3.5108280359557204`*^9}, 3.51082815537393*^9, {3.510829192042551*^9, 
   3.510829198968963*^9}, 3.510921040772647*^9, {3.510921527602702*^9, 
   3.5109215433743296`*^9}, 3.5109216695374184`*^9, {3.510996604937125*^9, 
   3.5109966973360877`*^9}, {3.510996781872636*^9, 3.510996813088291*^9}, {
   3.510996870636792*^9, 3.510997002581824*^9}, {3.5109971258376403`*^9, 
   3.51099747883506*^9}, {3.5109975113611174`*^9, 3.510997553933592*^9}, {
   3.511001153155122*^9, 3.511001156087927*^9}, {3.5110750067881613`*^9, 
   3.5110750247437935`*^9}, {3.511075073618679*^9, 3.511075082339094*^9}, {
   3.5111509028505797`*^9, 3.511150909776992*^9}, {3.511151323661319*^9, 
   3.5111513267501245`*^9}, {3.5111515407669*^9, 3.5111515575681295`*^9}, {
   3.5111520055229163`*^9, 3.5111520243209496`*^9}, {3.5111520566754065`*^9, 
   3.511152059140211*^9}, {3.511227851186803*^9, 3.5112278712796383`*^9}, {
   3.5112279062081003`*^9, 3.511227934147749*^9}, {3.5112281453565197`*^9, 
   3.5112281781321774`*^9}, {3.511228305974402*^9, 3.5112283073784046`*^9}, {
   3.511329672903357*^9, 3.5113297410754795`*^9}, {3.5114066216358414`*^9, 
   3.5114066439282804`*^9}, {3.5165100944528017`*^9, 
   3.5165101935129757`*^9}, {3.5165102674675055`*^9, 3.516510277669924*^9}, {
   3.5165104134057617`*^9, 3.5165104191933727`*^9}, {3.5165104781770763`*^9, 
   3.5165104835278854`*^9}, {3.5177046299518127`*^9, 3.517704655707458*^9}, {
   3.517706991686761*^9, 3.5177069948535666`*^9}, {3.5708988960682383`*^9, 
   3.5708989008285103`*^9}, {3.5708989922387385`*^9, 
   3.5708990801007643`*^9}, {3.570900432077093*^9, 3.570900433966201*^9}, {
   3.5709006027998576`*^9, 3.5709006031848793`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Function to generate a 3D graphics of eigen mode with reduced amplitude.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109215531087465`*^9, 3.510921628629079*^9}, 
   3.51092167323363*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eigenplot", "[", 
     RowBox[{
     "eigenv_List", ",", "amp_Real", ",", "n_Integer", ",", "opt___"}], "]"}],
     ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sub", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sub", "=", 
        RowBox[{"eigensub", "[", 
         RowBox[{"amp", " ", 
          RowBox[{"eigenv", "[", 
           RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"markerplot", "[", 
          RowBox[{
          "calc$maxx", ",", "calc$maxz", ",", "calc$ytop", ",", 
           "calc$ybottom"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"heatlinkplot", "[", "sub", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"wireplot", "[", "sub", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"bodyplot", "[", "sub", "]"}], ",", "opt"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5108253888990693`*^9, 3.5108254009110904`*^9}, {
   3.5108254380859556`*^9, 3.510825439801959*^9}, {3.5108277045487385`*^9, 
   3.510827749336417*^9}, {3.510828051789748*^9, 3.510828159102337*^9}, {
   3.510921608702939*^9, 3.510921675894782*^9}, {3.510921937011717*^9, 
   3.5109219397798758`*^9}, {3.5114287226395755`*^9, 3.511428781623279*^9}, {
   3.5114289087635026`*^9, 3.5114289126011095`*^9}, {3.512364121440639*^9, 
   3.512364128133051*^9}, {3.529658352200032*^9, 3.5296583673788586`*^9}, {
   3.5296584376101823`*^9, 3.5296584808534584`*^9}, {3.5296585355627546`*^9, 
   3.529658550788381*^9}, {3.52965863549653*^9, 3.5296586381329346`*^9}, {
   3.5296588681241384`*^9, 3.5296588721645455`*^9}, {3.5296589032866*^9, 
   3.529658976138728*^9}, {3.5296590615964794`*^9, 3.529659119628581*^9}, {
   3.5296593295113497`*^9, 3.529659338465766*^9}, {3.5296598269650235`*^9, 
   3.5296599505172405`*^9}, {3.5296600500922155`*^9, 
   3.5296600770334625`*^9}, {3.529660220662915*^9, 3.5296602312865334`*^9}, {
   3.5296603216106925`*^9, 3.529660344901533*^9}, 3.5296603807971964`*^9, {
   3.5296604180500617`*^9, 3.5296604293132815`*^9}, {3.571143761259348*^9, 
   3.5711437674527025`*^9}, {3.571416460124855*^9, 3.5714164713274956`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigenplot", "::", "usage"}], "=", 
   "\"\<eigenplot[eigenv,amp,n] shows 3D Graphics of n-th eigen mode, \nwhich \
is defined by 'eigenv' and number 'n'. 'amp' reduces or increases the \
amplitude\nof the eigen mode replacement.\>\""}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114286882883153`*^9, 3.51142869079992*^9}, {
   3.5114287909676957`*^9, 3.5114289588239903`*^9}, 3.529708177087821*^9}]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Transfer Function", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.511428979057226*^9, 3.5114289842676353`*^9}}],

Cell[CellGroupData[{

Cell["Making List", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5297191405755844`*^9, 3.5297191424936943`*^9}}],

Cell[CellGroupData[{

Cell["Make Frequency List", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5297195792566757`*^9, 3.5297195838999414`*^9}, 
   3.5297198876113124`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makefreqlist", "[", 
     RowBox[{"fmin_", ",", "fmax_", ",", "ngrid_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"imin", ",", "imax", ",", "dgrid"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"imin", "=", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "fmin"}], "]"}]}], ";", 
       RowBox[{"imax", "=", 
        RowBox[{"Log", "[", 
         RowBox[{"10", ",", "fmax"}], "]"}]}], ";", 
       RowBox[{"dgrid", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"imax", "-", "imin"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"ngrid", "-", "1"}], ")"}]}]}], ";", "\n", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"10", "^", "i"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "imin", ",", "imax", ",", "dgrid"}], "}"}]}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.529719160363716*^9, 3.5297191663680596`*^9}, {
   3.529719569770133*^9, 3.5297195907043304`*^9}, 3.5297198876113124`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate RMS amplitude from spectrum density", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5297195917943926`*^9, 3.5297196278704557`*^9}, 
   3.529719890978505*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makerms", "[", 
     RowBox[{"psd_", ",", "freq_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "psd", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "freq", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sqval", ",", "rms", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rms", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "freq", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"sqval", "=", "0"}], ";", 
         RowBox[{"l", "=", 
          RowBox[{"Length", "[", "freq", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sqval", "=", 
             RowBox[{"sqval", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"psd", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}], "2"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"freq", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"freq", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", "-", "n"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rms", "[", 
              RowBox[{"[", 
               RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}], "=", 
             RowBox[{"Sqrt", "[", "sqval", "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}], ";", 
         RowBox[{
          RowBox[{"rms", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"rms", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "rms"}]}], "]"}], ",", 
      "Null"}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.529719638741078*^9, 3.5297198128290353`*^9}, 
   3.5297198909795055`*^9, {3.5346912403913813`*^9, 3.534691275808407*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculate RMS velocity from spectrum density", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5297195917943926`*^9, 3.5297196278704557`*^9}, 
   3.529719890978505*^9, {3.5346911447339096`*^9, 3.5346911518783183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makermsvel", "[", 
     RowBox[{"psd_", ",", "freq_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "psd", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "freq", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"sqval", ",", "rms", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rms", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "freq", "]"}]}], "}"}]}], "]"}]}], ";", 
         RowBox[{"sqval", "=", "0"}], ";", 
         RowBox[{"l", "=", 
          RowBox[{"Length", "[", "freq", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sqval", "=", 
             RowBox[{"sqval", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"2", 
                  RowBox[{"N", "[", "Pi", "]"}], 
                  RowBox[{"freq", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}], 
                  RowBox[{"psd", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}]}], ")"}], 
                "2"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"freq", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"freq", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", "-", "n"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rms", "[", 
              RowBox[{"[", 
               RowBox[{"l", "-", "n", "+", "1"}], "]"}], "]"}], "=", 
             RowBox[{"Sqrt", "[", "sqval", "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"l", "-", "1"}]}], "}"}]}], "]"}], ";", 
         RowBox[{
          RowBox[{"rms", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"rms", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "rms"}]}], "]"}], ",", 
      "Null"}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.529719638741078*^9, 3.5297198128290353`*^9}, 
   3.5297198909795055`*^9, {3.5346911447339096`*^9, 3.534691154492468*^9}, {
   3.534691212806803*^9, 3.534691235177083*^9}, {3.5346912829758167`*^9, 
   3.534691321825039*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Usage Notes", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5109222925170507`*^9, 3.5109222959202456`*^9}, {
  3.5114290244065056`*^9, 3.511429025826108*^9}}],

Cell[CellGroupData[{

Cell["Actuator", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511425418573572*^9, 3.5114254240647817`*^9}}],

Cell[CellGroupData[{

Cell["Usage note for \"actuatorlist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
  3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
  3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
  3.510914645962615*^9, 3.5109146506738234`*^9}, {3.510914804271693*^9, 
  3.5109148120249066`*^9}, {3.5109152254256325`*^9, 3.5109152326952457`*^9}, {
  3.5109662405936275`*^9, 3.5109662413112288`*^9}, {3.5109700758135633`*^9, 
  3.510970077732367*^9}, {3.5113280986437917`*^9, 3.5113281133078175`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"actuatorlist", "::", "usage"}], "=", 
   "\"\<actuatorlist is a list of structures defining actuators. Each \
structure containing the following items:\n\tcoordinate list defining \
actuated body,\n\tattachment point for actuated body (local coordinates),\n\t\
coordinate list defining recoil body,\n\tattachment point for recoil body \
(local coordinates),\n\tworking direction at reciol body coordinate\>\""}], 
  ";"}], "\n", 
 RowBox[{"  "}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914683371481*^9, 3.5109147914640703`*^9}, {3.510914823459727*^9, 
   3.5109148388257537`*^9}, {3.5109148951262527`*^9, 
   3.5109149745771923`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109159867381697`*^9, 
   3.5109159889065733`*^9}, {3.510917661416711*^9, 3.5109176666583204`*^9}, {
   3.5109700860159817`*^9, 3.5109701553269033`*^9}, 3.5113281133078175`*^9, {
   3.5113281550050907`*^9, 3.511328156799094*^9}, {3.5114254269975867`*^9, 
   3.511425452831232*^9}, {3.5115159051347857`*^9, 3.511515905415586*^9}, {
   3.512724417567447*^9, 3.512724435381466*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Index constants for elemets of \"actuatorlist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109155299069676`*^9, 3.5109155451793947`*^9}, 
   3.5109156503703794`*^9, {3.5109701703185296`*^9, 3.5109701736413355`*^9}, 
   3.5113281133078175`*^9, 3.5114254150635653`*^9, 3.511425456918439*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a$bod1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a$pos1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a$bod2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a$pos2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a$dir", "=", "5"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True,
 CellChangeTimes->{{3.510915549531802*^9, 3.5109156503703794`*^9}, 
   3.510915990716177*^9, {3.5109176125106254`*^9, 3.5109176216366415`*^9}, {
   3.510970177478942*^9, 3.5109701918153677`*^9}, {3.5109728567680483`*^9, 
   3.5109728644744616`*^9}, {3.5109746122079315`*^9, 3.51097461701274*^9}, 
   3.5113281133078175`*^9, 3.5114254150635653`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensor (NOT USED IN THE CURRENT VERSION)", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114255467433968`*^9, 3.5114255476325984`*^9}, {
  3.512724452919469*^9, 3.512724468639368*^9}}],

Cell[CellGroupData[{

Cell["Usage note for \"sensorlist\".", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
  3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
  3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
  3.510914645962615*^9, 3.5109146506738234`*^9}, {3.510914804271693*^9, 
  3.5109148120249066`*^9}, {3.5109152254256325`*^9, 3.5109152326952457`*^9}, {
  3.5109662405936275`*^9, 3.5109662413112288`*^9}, {3.5109700758135633`*^9, 
  3.510970077732367*^9}, {3.5113280986437917`*^9, 3.5113281133078175`*^9}, {
  3.511414142128231*^9, 3.511414149429044*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sensorlist", "::", "usage"}], "=", 
     "\"\<sensorlist is is a list of structures defining sensors. \nEach \
structure containing the following items:\\n\n  \tcoordinate list defining \
sensed body,\\n\n  \tattachment point for sensed body (local coordinates),\\n\
\n  \tcoordinate list defining sensing body,\\n\n  \tattachment point for \
sensing body (local coordinates),\\n\n  \tworking direction at sensing body \
coordinate\>\""}], ";"}], "\n", "  "}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109117403711076`*^9, 3.5109117467515187`*^9}, {
   3.510911852816105*^9, 3.510911910286606*^9}, {3.510912394059056*^9, 
   3.510912394542657*^9}, {3.5109136076559916`*^9, 3.51091362965203*^9}, {
   3.510914683371481*^9, 3.5109147914640703`*^9}, {3.510914823459727*^9, 
   3.5109148388257537`*^9}, {3.5109148951262527`*^9, 
   3.5109149745771923`*^9}, {3.5109152254256325`*^9, 
   3.5109152326952457`*^9}, {3.5109159867381697`*^9, 
   3.5109159889065733`*^9}, {3.510917661416711*^9, 3.5109176666583204`*^9}, {
   3.5109700860159817`*^9, 3.5109701553269033`*^9}, 3.5113281133078175`*^9, {
   3.5113281550050907`*^9, 3.511328156799094*^9}, {3.511414142128231*^9, 
   3.5114141791938963`*^9}, {3.5114255101925325`*^9, 3.5114255326877728`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Index constants for elemets of \"sensorlist\"", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109155299069676`*^9, 3.5109155451793947`*^9}, 
   3.5109156503703794`*^9, {3.5109701703185296`*^9, 3.5109701736413355`*^9}, 
   3.5113281133078175`*^9, 3.511414142128231*^9, {3.5114254662472553`*^9, 
   3.511425505902525*^9}, {3.5123641553550987`*^9, 3.512364158537504*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"se$bod1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"se$pos1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"se$bod2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"se$pos2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"se$dir", "=", "5"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114255019557185`*^9, 3.511425505902525*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Transfer Function Plot", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114290660741787`*^9, 3.511429071066188*^9}}],

Cell[CellGroupData[{

Cell["Grind Line Setting", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.529718820537279*^9, 3.529718827564681*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mygrids1", "[", 
    RowBox[{"min_", ",", "max_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"1.", "*", "m", "*", 
         RowBox[{"10", "^", "n"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "9"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"Log10", "[", "min", "]"}], "]"}], "-", "1"}], ",", 
        RowBox[{"Floor", "[", 
         RowBox[{"Log10", "[", "max", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mygrids2", "[", 
    RowBox[{"min_", ",", "max_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"1.", "*", 
      RowBox[{"10", "^", "n"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"Log10", "[", "min", "]"}], "]"}], ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"Log10", "[", "max", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.529718832405958*^9, 3.529718865045825*^9}, 
   3.5297189605152855`*^9, {3.5711696957363114`*^9, 3.5711697173825493`*^9}, {
   3.5712185253702817`*^9, 3.5712185256832995`*^9}, {3.5712186396738195`*^9, 
   3.571218643410033*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["From Input Disp.", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511429082797408*^9, 3.511429096853033*^9}}],

Cell[CellGroupData[{

Cell["\<\
Function to calculate a transfer function from [input parameter] to [output \
variable].\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.505457309098371*^9, 3.5054573134988823`*^9}, {
   3.505457392369238*^9, 3.505457393435096*^9}, {3.507903438769166*^9, 
   3.507903442019352*^9}, {3.5079450761978855`*^9, 3.5079450876015053`*^9}, {
   3.507945118302359*^9, 3.507945140813199*^9}, {3.507945171342452*^9, 
   3.5079451800940676`*^9}, {3.50934963258302*^9, 3.509349636966628*^9}, {
   3.510536034824462*^9, 3.510536038350068*^9}, {3.510629939058976*^9, 
   3.5106299562190065`*^9}, {3.5106327050338364`*^9, 3.510632709417444*^9}, {
   3.5106379074417734`*^9, 3.5106379146801863`*^9}, 3.510639470065318*^9, {
   3.5109223193235846`*^9, 3.510922379302015*^9}, 3.510922541555295*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tfcalc", "[", 
     RowBox[{"invar_", ",", "outvar_", ",", "freq_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numin", ",", "numout", ",", "numgrid", ",", "vecM0", ",", "vecK0", 
        ",", "vecG0", ",", "tf", ",", "tfL", ",", "ss"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"allparams", ",", "invar"}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"allvars", ",", "outvar"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Null", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numin", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"allparams", ",", "invar"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"numout", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"allvars", ",", "outvar"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"numgrid", "=", 
          RowBox[{"Length", "[", "freq", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecM0", "=", 
          RowBox[{"matMpv", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "numin"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vecK0", "=", 
          RowBox[{"matKpvc", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "numin"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vecG0", "=", 
          RowBox[{"matGpv", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "numin"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tfL", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "numgrid"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ss", "=", 
             RowBox[{"2", 
              RowBox[{"N", "[", "Pi", "]"}], "I", " ", 
              RowBox[{"freq", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tf", "=", 
             RowBox[{"LinearSolve", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["ss", "2"], "matMvv"}], "+", 
                 RowBox[{"ss", " ", "matGvv"}], "+", "matKvvc"}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["ss", "2"]}], "vecM0"}], "-", 
                 RowBox[{"ss", " ", "vecG0"}], "-", "vecK0"}], ")"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tfL", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "=", 
             RowBox[{"tf", "[", 
              RowBox[{"[", "numout", "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "numgrid"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "tfL"}]}], "\[IndentingNewLine]",
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106299906170664`*^9, 3.510630042799158*^9}, {
   3.5106303315520678`*^9, 3.5106303994745865`*^9}, {3.5106308365873547`*^9, 
   3.5106308875214443`*^9}, {3.510630972354393*^9, 3.5106310601981473`*^9}, {
   3.510631114018242*^9, 3.5106311291346684`*^9}, {3.5106311609899244`*^9, 
   3.5106311748895483`*^9}, {3.510631214326418*^9, 3.510631262733303*^9}, {
   3.510631302045372*^9, 3.5106313591882725`*^9}, {3.510631408047558*^9, 
   3.5106314579676456`*^9}, {3.5106316663060117`*^9, 
   3.5106317601401763`*^9}, {3.5106317970966415`*^9, 
   3.5106318608695536`*^9}, {3.510631922723662*^9, 3.51063204679068*^9}, {
   3.510632127052821*^9, 3.510632149969261*^9}, {3.510632467570219*^9, 
   3.510632531187131*^9}, {3.510632586629628*^9, 3.510632616940481*^9}, {
   3.510632676688586*^9, 3.5106326789193907`*^9}, {3.5106578640351844`*^9, 
   3.5106578690739937`*^9}, {3.510922387631491*^9, 3.5109224299679127`*^9}, {
   3.510922471023261*^9, 3.510922541555295*^9}, {3.5109559084082375`*^9, 
   3.510955918126794*^9}, {3.510955990196916*^9, 3.510956001059537*^9}, {
   3.5109604129012737`*^9, 3.51096042207409*^9}, {3.5111469708480735`*^9, 
   3.5111469878833036`*^9}, {3.51123079860918*^9, 3.511230831135237*^9}, {
   3.51123157847015*^9, 3.511231590341771*^9}, {3.5113902388817205`*^9, 
   3.5113902760565853`*^9}, {3.5113904154740305`*^9, 3.5113904190776367`*^9}, 
   3.5114290481809473`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plot transfer functions from [input parameter] to [output variable].\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106394733257236`*^9, 3.5106394932313585`*^9}, {
   3.5106395730962996`*^9, 3.510639574016701*^9}, {3.510922558037238*^9, 
   3.5109225658306837`*^9}, 3.510923084194332*^9, {3.510957071751405*^9, 
   3.51095709724185*^9}, {3.510957128440305*^9, 3.5109571349299164`*^9}, 
   3.510958922084656*^9, {3.5114291106434574`*^9, 3.511429115822666*^9}, 
   3.5114292166612434`*^9, {3.5114292997157893`*^9, 3.511429308139804*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tfplot", "[", 
     RowBox[{
     "invar_List", ",", "outvar_List", ",", "freq_List", ",", "option___"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tf", ",", "len"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"allparams", ",", 
               RowBox[{"invar", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", 
               RowBox[{"Length", "[", "invar", "]"}]}], "}"}]}], "]"}], ",", 
           "False"}], "]"}], "||", "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"allvars", ",", 
               RowBox[{"outvar", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], "]"}], ",", 
           "False"}], "]"}]}], ",", "\[IndentingNewLine]", "Null", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tf", "=", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tfcalc", "[", 
             RowBox[{
              RowBox[{"invar", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"outvar", "[", 
               RowBox[{"[", "m", "]"}], "]"}], ",", "freq"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"len", "=", "\[IndentingNewLine]", 
          RowBox[{"Max", "[", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"StringLength", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"outvar", "[", 
                 RowBox[{"[", "m", "]"}], "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"invar", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"n", ",", 
               RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"comb", "[", 
                RowBox[{"freq", ",", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"tf", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "m"}], "]"}], "]"}], "]"}]}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"n", ",", 
                 RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "1"}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", "option", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", "\"\<Frequency [Hz]\>\"", "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BaseStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"FontSize", "\[Rule]", "20"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLegend", "\[Rule]", "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"outvar", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "<>", "\"\</\>\"", 
                   "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"invar", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}]}], ",", "14"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", 
                  RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "1"}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"LegendPosition", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.35", ",", "0.3"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LegendSpacing", "\[Rule]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LegendTextSpace", "\[Rule]", "2.5"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LegendSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0.2", "+", 
               RowBox[{"0.023", "len"}]}], ",", 
              RowBox[{"0.08", " ", 
               RowBox[{"Length", "[", "invar", "]"}], 
               RowBox[{"Length", "[", "outvar", "]"}]}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106379207173967`*^9, 3.5106380235683775`*^9}, {
   3.5106380577480373`*^9, 3.5106380857344866`*^9}, {3.510638147058194*^9, 
   3.5106383190328965`*^9}, {3.510638376799798*^9, 3.510638382946209*^9}, {
   3.5106385677285337`*^9, 3.510638581222557*^9}, {3.5106390869910455`*^9, 
   3.5106390886290483`*^9}, {3.510639157581169*^9, 3.5106391771280036`*^9}, {
   3.5106392282804937`*^9, 3.5106392311040983`*^9}, {3.5106393745619507`*^9, 
   3.5106393757163525`*^9}, {3.510639431829651*^9, 3.510639438584463*^9}, {
   3.5106395913171315`*^9, 3.5106395942967367`*^9}, {3.5106396926549096`*^9, 
   3.5106396972881174`*^9}, {3.5106397446030006`*^9, 3.510639744743401*^9}, {
   3.510922640000926*^9, 3.51092272749093*^9}, {3.510923158334573*^9, 
   3.5109231671970797`*^9}, {3.510923198110848*^9, 3.51092321860602*^9}, {
   3.5109559831785145`*^9, 3.5109559876367693`*^9}, {3.510956077187258*^9, 
   3.5109561358745613`*^9}, {3.51095618629385*^9, 3.5109562458391542`*^9}, {
   3.5109563075840626`*^9, 3.5109563077244625`*^9}, {3.5109563428245244`*^9, 
   3.510956349282936*^9}, {3.5109563951626167`*^9, 3.5109564050374336`*^9}, {
   3.5109564483899097`*^9, 3.510956462242734*^9}, {3.51095656219211*^9, 
   3.5109566018317795`*^9}, {3.510956657367877*^9, 3.510956660893483*^9}, {
   3.5109567218895903`*^9, 3.5109567222795906`*^9}, {3.510956776052885*^9, 
   3.5109569174047337`*^9}, 3.510957071751405*^9, {3.510957271539356*^9, 
   3.5109575204221935`*^9}, {3.510957573758687*^9, 3.5109575839611053`*^9}, {
   3.510957613991158*^9, 3.5109577304297624`*^9}, {3.5109578222983236`*^9, 
   3.5109579245253034`*^9}, {3.5109579651477747`*^9, 3.51095797374339*^9}, {
   3.5109586946674557`*^9, 3.510958695322657*^9}, 3.510958922084656*^9, {
   3.5109594444047728`*^9, 3.510959446838377*^9}, {3.5109599196440077`*^9, 
   3.5109600378610153`*^9}, {3.51096011456635*^9, 3.5109602173081303`*^9}, {
   3.5109642535545373`*^9, 3.5109642810573854`*^9}, 3.5109649897978306`*^9, 
   3.5114143144773335`*^9, 3.5114292166612434`*^9, {3.5470751373904185`*^9, 
   3.5470751376674347`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tfplot", "::", "usage"}], "=", 
    "\"\<tfplot[{param},{var},freqlist] calculates transfer functions from \
input parameters' displacement to output variables' displacement.\>\""}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.511429134339899*^9, 3.5114292166612434`*^9}, {
   3.5114294308808193`*^9, 3.5114294313644204`*^9}, {3.5127277414039125`*^9, 
   3.5127277416379128`*^9}, 3.5714893634476833`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["From Input Force", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5114292418396873`*^9, 3.511429250076502*^9}}],

Cell[CellGroupData[{

Cell["\<\
Substitution for strings which replaces \"x\", \"y\", \"z\", \
\"pitch\",\"yaw\",\"roll\" to \"Fx\", \"Fy\", \"Fz\", \"Tx\", \"Ty\", \"Tz\".\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.5109636477274733`*^9, 3.5109636969455595`*^9}, 
   3.5109638811038833`*^9, {3.5109641564599667`*^9, 3.510964176911603*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"subforce", "[", "str_String", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"str", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<pitch\>\"", "\[Rule]", "\"\<Tx\>\""}], ",", 
        RowBox[{"\"\<yaw\>\"", "\[Rule]", "\"\<Ty\>\""}], ",", 
        RowBox[{"\"\<roll\>\"", "\[Rule]", "\"\<Tz\>\""}], ",", 
        RowBox[{"\"\<x\>\"", "\[Rule]", "\"\<Fx\>\""}], ",", 
        RowBox[{"\"\<y\>\"", "\[Rule]", "\"\<Fy\>\""}], ",", 
        RowBox[{"\"\<z\>\"", "\[Rule]", "\"\<Fz\>\""}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.51096370847398*^9, 3.5109638811038833`*^9}, {
   3.5109640882878475`*^9, 3.5109641404075384`*^9}, 3.5109641819036117`*^9, {
   3.5115160451138315`*^9, 3.511516048998238*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"subforce", "::", "usage"}], "=", "\[IndentingNewLine]", 
   "\"\<Substitution for strings which replaces x, y, z, pitch, yaw, roll to \
Fx, Fy, Fz, Tx, Ty, Tz.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.57148979226221*^9, 3.571489847089346*^9}}],

Cell[CellGroupData[{

Cell["\<\
Function to calculate a transfer function from [force / torque corresponding \
to input variable] to [output variable].\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.505457309098371*^9, 3.5054573134988823`*^9}, {
   3.505457392369238*^9, 3.505457393435096*^9}, {3.507903438769166*^9, 
   3.507903442019352*^9}, {3.5079450761978855`*^9, 3.5079450876015053`*^9}, {
   3.507945118302359*^9, 3.507945140813199*^9}, {3.507945171342452*^9, 
   3.5079451800940676`*^9}, {3.50934963258302*^9, 3.509349636966628*^9}, {
   3.510536034824462*^9, 3.510536038350068*^9}, {3.510629939058976*^9, 
   3.5106299562190065`*^9}, {3.5106327050338364`*^9, 3.510632709417444*^9}, {
   3.5106379074417734`*^9, 3.5106379146801863`*^9}, 3.510639470065318*^9, {
   3.5109223193235846`*^9, 3.510922379302015*^9}, 3.510922541555295*^9, {
   3.510958965780332*^9, 3.5109589664511337`*^9}, {3.510959121609006*^9, 
   3.510959139486637*^9}, {3.5109592735688725`*^9, 3.510959279247283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tfcalcf", "[", 
     RowBox[{"invar_", ",", "outvar_", ",", "freq_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coeff", ",", "dummy", ",", "numout", ",", "numgrid", ",", "vecin", 
        ",", "tf", ",", "tfL", ",", "ss"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coeff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"invar", ",", 
            RowBox[{"allvars", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dummy", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"coeff", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dummy", "\[Equal]", "0"}], "||", 
          RowBox[{"Not", "[", 
           RowBox[{"NumericQ", "[", "dummy", "]"}], "]"}], "||", 
          RowBox[{"Not", "[", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"allvars", ",", "outvar"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"numout", "=", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"allvars", ",", "outvar"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numgrid", "=", 
           RowBox[{"Length", "[", "freq", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"vecin", "=", "coeff"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tfL", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", "numgrid"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ss", "=", 
              RowBox[{"2", 
               RowBox[{"N", "[", "Pi", "]"}], "I", " ", 
               RowBox[{"freq", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tf", "=", 
              RowBox[{"LinearSolve", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["ss", "2"], "matMvv"}], "+", 
                  RowBox[{"ss", " ", "matGvv"}], "+", "matKvvc"}], ")"}], ",",
                 "vecin"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"tfL", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "=", 
              RowBox[{"tf", "[", 
               RowBox[{"[", "numout", "]"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "numgrid"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "tfL"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzlkow3EAB/BZSxrJHkTIHJN5MB6Qm+UBD8ux1XKEaKQp2xyjhHJlIi1X
mSPXgxyztORhWi1pKJlaRPEy+ZOjRGaZ3/f38O1T374P3+j61nIFm8Vi8Ukg
+8hx9hfPiPf1FQ6o21R/w4ukNy80nOrTvMSt3fdsmCwfK4QZ8uFyqJrOr4Ap
JYIq2LnNr4Ui7W0d5GjsCpiudSqhsc2qgjJflxbODfn0ws+v3EF4bS9ehNIe
zibdh6zuwHrHvBnmCOUWmC+5Podm44OT/uIc3cDsPA2bJWTEbo+CC5k4GQ+2
hEYGQ5ffTATcUN5Rs6J8mgOIwpoVamJqu36cKPixzMIJy70Bum1767AoaPx9
gWgKtH3AWMmxGx4+Rnugo9VXtUSUKnnUk6vLLuhiXvtovxE1Cs0R6dTB5/BZ
WPmUuQAbhQfxy0RjzVoCXOsMK/glPjXlUq0iLleTwIhDpwb8oS6mTD1E7DDt
d0PL/eMILK1u0EFDv2AS2l5k1H+lbfhQ
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Plot force/torque transfer functions  from [force / torque corresponding to \
input variable] to [output variable].\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106394733257236`*^9, 3.5106394932313585`*^9}, {
   3.5106395730962996`*^9, 3.510639574016701*^9}, {3.510922558037238*^9, 
   3.5109225658306837`*^9}, 3.510923084194332*^9, {3.510957071751405*^9, 
   3.51095709724185*^9}, {3.510957128440305*^9, 3.5109571349299164`*^9}, 
   3.510958922084656*^9, {3.510964054342188*^9, 3.510964059240596*^9}, 
   3.5114292938969793`*^9, 3.511429420772002*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tfplotf", "[", 
     RowBox[{
     "invar_List", ",", "outvar_List", ",", "freq_List", ",", "option___"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeff", ",", "dummy", ",", "tf", ",", "len"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coeff", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"invar", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"allvars", "[", 
             RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dummy", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"coeff", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "m"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"dummy", "\[Equal]", "0"}], "||", 
          RowBox[{"Not", "[", 
           RowBox[{"NumericQ", "[", "dummy", "]"}], "]"}], "||", 
          "\[IndentingNewLine]", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"allvars", ",", 
                RowBox[{"outvar", "[", 
                 RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], "]"}], ",",
             "False"}], "]"}]}], ",", "\[IndentingNewLine]", "Null", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tf", "=", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tfcalcf", "[", 
              RowBox[{
               RowBox[{"invar", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"outvar", "[", 
                RowBox[{"[", "m", "]"}], "]"}], ",", "freq"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"n", ",", 
               RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"len", "=", "\[IndentingNewLine]", 
           RowBox[{"Max", "[", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"StringLength", "[", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"outvar", "[", 
                  RowBox[{"[", "m", "]"}], "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
                RowBox[{"subforce", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"invar", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"comb", "[", 
                 RowBox[{"freq", ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"tf", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "m"}], "]"}], "]"}], "]"}]}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", 
                  RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "1"}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "option", ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", "\"\<Frequency [Hz]\>\"", "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"BaseStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"FontSize", "\[Rule]", "20"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotLegend", "\[Rule]", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"outvar", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], "]"}], "<>", "\"\</\>\"", 
                    "<>", 
                    RowBox[{"subforce", "[", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"invar", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "]"}], "]"}]}], ",", 
                   "14"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", 
                   RowBox[{"Length", "[", "invar", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"Length", "[", "outvar", "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "1"}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"LegendPosition", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.35", ",", "0.3"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendSpacing", "\[Rule]", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendTextSpace", "\[Rule]", "2.5"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendShadow", "\[Rule]", "None"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"LegendSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.2", "+", 
                RowBox[{"0.025", "len"}]}], ",", 
               RowBox[{"0.08", " ", 
                RowBox[{"Length", "[", "invar", "]"}], 
                RowBox[{"Length", "[", "outvar", "]"}]}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106379207173967`*^9, 3.5106380235683775`*^9}, {
   3.5106380577480373`*^9, 3.5106380857344866`*^9}, {3.510638147058194*^9, 
   3.5106383190328965`*^9}, {3.510638376799798*^9, 3.510638382946209*^9}, {
   3.5106385677285337`*^9, 3.510638581222557*^9}, {3.5106390869910455`*^9, 
   3.5106390886290483`*^9}, {3.510639157581169*^9, 3.5106391771280036`*^9}, {
   3.5106392282804937`*^9, 3.5106392311040983`*^9}, {3.5106393745619507`*^9, 
   3.5106393757163525`*^9}, {3.510639431829651*^9, 3.510639438584463*^9}, {
   3.5106395913171315`*^9, 3.5106395942967367`*^9}, {3.5106396926549096`*^9, 
   3.5106396972881174`*^9}, {3.5106397446030006`*^9, 3.510639744743401*^9}, {
   3.510922640000926*^9, 3.51092272749093*^9}, {3.510923158334573*^9, 
   3.5109231671970797`*^9}, {3.510923198110848*^9, 3.51092321860602*^9}, {
   3.5109559831785145`*^9, 3.5109559876367693`*^9}, {3.510956077187258*^9, 
   3.5109561358745613`*^9}, {3.51095618629385*^9, 3.5109562458391542`*^9}, {
   3.5109563075840626`*^9, 3.5109563077244625`*^9}, {3.5109563428245244`*^9, 
   3.510956349282936*^9}, {3.5109563951626167`*^9, 3.5109564050374336`*^9}, {
   3.5109564483899097`*^9, 3.510956462242734*^9}, {3.51095656219211*^9, 
   3.5109566018317795`*^9}, {3.510956657367877*^9, 3.510956660893483*^9}, {
   3.5109567218895903`*^9, 3.5109567222795906`*^9}, {3.510956776052885*^9, 
   3.5109569174047337`*^9}, 3.510957071751405*^9, {3.510957271539356*^9, 
   3.5109575204221935`*^9}, {3.510957573758687*^9, 3.5109575839611053`*^9}, {
   3.510957613991158*^9, 3.5109577304297624`*^9}, {3.5109578222983236`*^9, 
   3.5109579245253034`*^9}, {3.5109579651477747`*^9, 3.51095797374339*^9}, {
   3.5109586946674557`*^9, 3.510958695322657*^9}, 3.510958922084656*^9, {
   3.5109594444047728`*^9, 3.510959446838377*^9}, {3.5109599196440077`*^9, 
   3.5109600378610153`*^9}, {3.51096011456635*^9, 3.5109602173081303`*^9}, {
   3.510964310167037*^9, 3.510964358261921*^9}, 3.5109644427984695`*^9, 
   3.5109649788310113`*^9, {3.510965032307905*^9, 3.510965041371521*^9}, {
   3.510965218230232*^9, 3.510965242238674*^9}, {3.5109652881495543`*^9, 
   3.510965300941577*^9}, 3.5114143060221186`*^9, 3.511429420772002*^9, {
   3.5114298040322757`*^9, 3.5114298712059937`*^9}, 3.547075151063201*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tfplotf", "::", "usage"}], "=", 
    "\"\<tfplot[{varin},{varout},freq] calculates transfer functions from \
force exerted to the input variables, to output variables' \
displacement.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.511429330260643*^9, 3.5114293833163357`*^9}, {
   3.5127277366459036`*^9, 3.512727737191905*^9}, 3.5714893509929705`*^9}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Make TF with frequency dependent stiffness (of heat links)", \
"Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.54500946920732*^9, 3.545009470790411*^9}, {
  3.571489442977232*^9, 3.5714894580420938`*^9}}],

Cell[CellGroupData[{

Cell["Ground to bodies", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.571489467027608*^9, 3.5714895008375416`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tfcalcFD1", "[", 
    RowBox[{"invar_", ",", "outvar_", ",", "freq_List", ",", "subHLC_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coeff1", ",", "coeff2", ",", "dummy1", ",", "dummy2", ",", "vecout", 
       ",", "numgrid", ",", "vecin", ",", "tf", ",", "tfL", ",", "ss", ",", 
       "vecM0", ",", "vecG0", ",", "vecK0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"invar", ",", 
           RowBox[{"allparams", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allparams", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"coeff2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"outvar", ",", 
           RowBox[{"allvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy1", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"coeff1", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allparams", "]"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"dummy2", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"coeff2", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dummy1", "\[Equal]", "0"}], "||", 
           RowBox[{"Not", "[", 
            RowBox[{"NumericQ", "[", "dummy1", "]"}], "]"}]}], ")"}], "||", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dummy2", "\[Equal]", "0"}], "||", 
           RowBox[{"Not", "[", 
            RowBox[{"NumericQ", "[", "dummy2", "]"}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", "Null", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numgrid", "=", 
          RowBox[{"Length", "[", "freq", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecin", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "coeff1", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecout", "=", "coeff2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecM0", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"matMpv", ".", "vecin"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecK0", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"matKpvc", ".", "vecin"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecG0", "=", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"matGpv", ".", "vecin"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tfL", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "numgrid"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ss", "=", 
             RowBox[{"2", 
              RowBox[{"N", "[", "Pi", "]"}], "I", " ", 
              RowBox[{"freq", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tf", "=", 
             RowBox[{"LinearSolve", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["ss", "2"], "matMvv"}], "+", 
                 RowBox[{"ss", " ", "matGvv"}], "+", 
                 RowBox[{"(", 
                  RowBox[{"matKvvc", "/.", 
                   RowBox[{"subHLC", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["ss", "2"]}], "vecM0"}], "-", 
                 RowBox[{"ss", " ", "vecG0"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"vecK0", "/.", 
                   RowBox[{"subHLC", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], ")"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tfL", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "=", 
             RowBox[{"tf", ".", "vecout"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "numgrid"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "tfL"}]}], "\[IndentingNewLine]",
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5106299906170664`*^9, 3.510630042799158*^9}, {
   3.5106303315520678`*^9, 3.5106303994745865`*^9}, {3.5106308365873547`*^9, 
   3.5106308875214443`*^9}, {3.510630972354393*^9, 3.5106310601981473`*^9}, {
   3.510631114018242*^9, 3.5106311291346684`*^9}, {3.5106311609899244`*^9, 
   3.5106311748895483`*^9}, {3.510631214326418*^9, 3.510631262733303*^9}, {
   3.510631302045372*^9, 3.5106313591882725`*^9}, {3.510631408047558*^9, 
   3.5106314579676456`*^9}, {3.5106316663060117`*^9, 
   3.5106317601401763`*^9}, {3.5106317970966415`*^9, 
   3.5106318608695536`*^9}, {3.510631922723662*^9, 3.51063204679068*^9}, {
   3.510632127052821*^9, 3.510632149969261*^9}, {3.510632467570219*^9, 
   3.510632531187131*^9}, {3.510632586629628*^9, 3.510632616940481*^9}, {
   3.510632676688586*^9, 3.5106326789193907`*^9}, {3.5106578640351844`*^9, 
   3.5106578690739937`*^9}, {3.510922387631491*^9, 3.5109224299679127`*^9}, {
   3.510922471023261*^9, 3.510922541555295*^9}, {3.5109559084082375`*^9, 
   3.510955918126794*^9}, {3.510955990196916*^9, 3.510956001059537*^9}, {
   3.5109604129012737`*^9, 3.51096042207409*^9}, {3.5111469708480735`*^9, 
   3.5111469878833036`*^9}, {3.51123079860918*^9, 3.511230831135237*^9}, {
   3.51123157847015*^9, 3.511231590341771*^9}, {3.5113902388817205`*^9, 
   3.5113902760565853`*^9}, {3.5113904154740305`*^9, 3.5113904190776367`*^9}, 
   3.5114290481809473`*^9, {3.545008436757268*^9, 3.5450084369502788`*^9}, {
   3.5450085320727196`*^9, 3.5450085467735605`*^9}, {3.545008599115554*^9, 
   3.545008693438949*^9}, {3.5450087410766735`*^9, 3.54500878663328*^9}, {
   3.5450088240004168`*^9, 3.5450088577583475`*^9}, {3.5450089586701193`*^9, 
   3.545008981781441*^9}, {3.5450090428849363`*^9, 3.545009056781731*^9}, {
   3.545009100748246*^9, 3.545009139332453*^9}, {3.545009294781344*^9, 
   3.545009318758715*^9}, {3.5450094431818323`*^9, 3.5450094594157605`*^9}, {
   3.5450094966878924`*^9, 3.5450095341040325`*^9}, {3.545010376744229*^9, 
   3.545010385696741*^9}, {3.54501115722287*^9, 3.5450111580739183`*^9}, {
   3.5552978072622333`*^9, 3.5552978474445314`*^9}, {3.5552979041057725`*^9, 
   3.5552979580118556`*^9}, {3.555302291409712*^9, 3.555302298321107*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tfcalcFD1", "::", "usage"}], "=", "\[IndentingNewLine]", 
   "\"\<tfplotFD1[{varin},{varout},freq,sub] calculates transfer functions \
from the displacement about the input variables, to the displacement about \
the output variables. You need to give frequency dependence of the spring \
constants in 'sub'. 'sub' should be a list of substitutions converting \
symbols to the stiffness values.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571489511572156*^9, 3.571489726745463*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Force TF", "Subsubsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5714895064968653`*^9, 3.5714895079959507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tfcalcfFD1", "[", 
    RowBox[{"invar_", ",", "outvar_", ",", "freq_List", ",", "subHLC_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coeff1", ",", "coeff2", ",", "dummy1", ",", "dummy2", ",", "vecout", 
       ",", "numgrid", ",", "vecin", ",", "tf", ",", "tfL", ",", "ss"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"invar", ",", 
           RowBox[{"allvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeff2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"outvar", ",", 
           RowBox[{"allvars", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy1", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"coeff1", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy2", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"coeff2", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dummy1", "\[Equal]", "0"}], "||", 
           RowBox[{"Not", "[", 
            RowBox[{"NumericQ", "[", "dummy1", "]"}], "]"}]}], ")"}], "||", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dummy2", "\[Equal]", "0"}], "||", 
           RowBox[{"Not", "[", 
            RowBox[{"NumericQ", "[", "dummy2", "]"}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", "Null", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"numgrid", "=", 
          RowBox[{"Length", "[", "freq", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecin", "=", "coeff1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecout", "=", "coeff2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"tfL", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "numgrid"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ss", "=", 
             RowBox[{"2", 
              RowBox[{"N", "[", "Pi", "]"}], "I", " ", 
              RowBox[{"freq", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tf", "=", 
             RowBox[{"LinearSolve", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["ss", "2"], "matMvv"}], "+", 
                 RowBox[{"ss", " ", "matGvv"}], "+", 
                 RowBox[{"(", 
                  RowBox[{"matKvvc", "/.", 
                   RowBox[{"subHLC", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ")"}]}], ")"}], ",", 
               "vecin"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tfL", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "=", 
             RowBox[{"tf", ".", "vecout"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "numgrid"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "tfL"}]}], "\[IndentingNewLine]",
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.545009331740458*^9, 3.545009371395726*^9}, {
  3.545009405853697*^9, 3.5450094178093805`*^9}, {3.545009510390676*^9, 
  3.545009513384847*^9}, {3.5450111743678503`*^9, 3.5450112055776353`*^9}, {
  3.55529791735853*^9, 3.555297952417536*^9}, {3.555302301099266*^9, 
  3.555302302329336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tfcalcfFD1", "::", "usage"}], "=", "\[IndentingNewLine]", 
   "\"\<tfplotfFD1[{varin},{varout},freq,sub] calculates transfer functions \
from the force / torque exerted to the input variables, to the displacement \
about the output variables. You need to give frequency dependence of the \
spring constants in 'sub'. 'sub' should be a list of substitutions converting \
symbols to the stiffness values.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571489744299467*^9, 3.571489760357385*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Seismic Noise", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5127317803526115`*^9, 3.5127317830670156`*^9}}],

Cell[CellGroupData[{

Cell["Frequency Plot", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5123572932384334`*^9, 3.5123573024112496`*^9}, {
  3.512731870099569*^9, 3.512731872611173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"freqplot", "[", 
    RowBox[{"val_List", ",", "freq_List", ",", "option___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", ",", "dummy"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"val", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "val", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dummy", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"len", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "\[Equal]", 
          RowBox[{"Length", "[", "freq", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "len", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"dummy", ",", "False"}], "]"}], ",", "Null", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListLogLogPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"comb", "[", 
             RowBox[{"freq", ",", 
              RowBox[{"Abs", "[", 
               RowBox[{"val", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"Length", "[", "val", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "option",
           ",", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", "\"\<Frequency [Hz]\>\"", "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "20"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "600"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5123567804031324`*^9, 3.5123569578846445`*^9}, 
   3.5123573024112496`*^9, {3.512731896822416*^9, 3.512731898710019*^9}, {
   3.512731945993702*^9, 3.512731963138132*^9}, {3.5127320636959085`*^9, 
   3.5127321208232093`*^9}, {3.5127321551432695`*^9, 3.5127322140801735`*^9}, 
   3.547075236338078*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"freqplot", "::", "usage"}], "=", 
   "\"\<freqplot[{val},freq,option] makes plots of 'val' vs 'freq'.\>\""}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.512731991171382*^9, 3.5127320425110717`*^9}, {
  3.5127322437358255`*^9, 3.5127323600340295`*^9}, {3.5711671959313307`*^9, 
  3.5711671968913856`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MATLAB Export", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.511430370999672*^9, 3.5114303738232765`*^9}}],

Cell[CellGroupData[{

Cell["Making Input/Output Vectors", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511337729825916*^9, 3.5113377330239215`*^9}, {
  3.5114303918881083`*^9, 3.511430404976531*^9}, {3.5114304713546476`*^9, 
  3.511430480309064*^9}}],

Cell[CellGroupData[{

Cell["Make input vector from input parameter list", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113458756298475`*^9, 3.511345879342654*^9}, 
   3.511346162498751*^9, 3.5113919865527897`*^9, {3.511393182398491*^9, 
   3.5113931959393144`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeinputvecp", "[", "inputp_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "inputp", "]"}], "\[Equal]", "0"}], "||", 
       "\[IndentingNewLine]", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"allparams", ",", 
             RowBox[{"inputp", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "inputp", "]"}]}], "}"}]}], "]"}], ",", 
         "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "allparams", "]"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"allparams", "/.", 
           RowBox[{
            RowBox[{"inputp", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", "1"}]}], "/.", 
          RowBox[{"makesub0", "[", "allparams", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "inputp", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113458830242605`*^9, 3.511345985781641*^9}, {
   3.511346033720525*^9, 3.5113460743273964`*^9}, {3.511346106151452*^9, 
   3.511346162498751*^9}, {3.511346235257279*^9, 3.511346244835696*^9}, {
   3.5113463594334974`*^9, 3.511346381647936*^9}, {3.51134641237999*^9, 
   3.5113465658062596`*^9}, {3.5113466379875865`*^9, 3.5113466563020186`*^9}, 
   3.5113467818354387`*^9, {3.511347774808383*^9, 3.5113477826083965`*^9}, 
   3.5113919865527897`*^9, {3.511392315697768*^9, 3.51139233956581*^9}, {
   3.511393201664524*^9, 3.5113932143629465`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Make input vector from input force list", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113458756298475`*^9, 3.511345879342654*^9}, 
   3.511346162498751*^9, 3.5113919865527897`*^9, {3.511393182398491*^9, 
   3.5113931959393144`*^9}, 3.5113934948982396`*^9, {3.511393790129958*^9, 
   3.5113937908007593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeinputvecf", "[", "inputf_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "inputf", "]"}], "\[Equal]", "0"}], "||", 
       "\[IndentingNewLine]", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"allvars", ",", 
             RowBox[{"inputf", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "inputf", "]"}]}], "}"}]}], "]"}], ",", 
         "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "allvars", "]"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"allvars", "/.", 
           RowBox[{
            RowBox[{"inputf", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", "1"}]}], "/.", 
          RowBox[{"makesub0", "[", "allvars", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "inputf", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113458830242605`*^9, 3.511345985781641*^9}, {
   3.511346033720525*^9, 3.5113460743273964`*^9}, {3.511346106151452*^9, 
   3.511346162498751*^9}, {3.511346235257279*^9, 3.511346244835696*^9}, {
   3.5113463594334974`*^9, 3.511346381647936*^9}, {3.51134641237999*^9, 
   3.5113465658062596`*^9}, {3.5113466379875865`*^9, 3.5113466563020186`*^9}, 
   3.5113467818354387`*^9, {3.511347774808383*^9, 3.5113477826083965`*^9}, 
   3.5113919865527897`*^9, {3.511392315697768*^9, 3.51139233956581*^9}, {
   3.511393201664524*^9, 3.5113932143629465`*^9}, {3.5113934948982396`*^9, 
   3.5113935182514806`*^9}, {3.5113937371678653`*^9, 3.511393760068705*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Make input vector from input actuator list", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511345781546082*^9, 3.5113457972709093`*^9}, 
   3.511393451608164*^9, {3.5113937960579686`*^9, 3.5113938004727764`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeinputveca", "[", "inputa_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "inputa", "]"}], "\[Equal]", "0"}], "||", 
       "\[IndentingNewLine]", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"allacts", ",", 
             RowBox[{"inputa", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "inputa", "]"}]}], "}"}]}], "]"}], ",", 
         "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"allvars", "/.", 
           RowBox[{"reaction", "[", 
            RowBox[{"actuatorlist", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"allacts", ",", 
                 RowBox[{"inputa", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "]"}]}], 
          "/.", "\[IndentingNewLine]", 
          RowBox[{"makesub0", "[", "allvars", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "inputa", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511345121680523*^9, 3.511345153582579*^9}, {
   3.511345202285865*^9, 3.5113452572447615`*^9}, {3.511345301221238*^9, 
   3.511345350922926*^9}, {3.511345463711124*^9, 3.511345480106753*^9}, {
   3.511345554097683*^9, 3.5113455785117254`*^9}, {3.5113456086821785`*^9, 
   3.5113456111001825`*^9}, {3.511345679428303*^9, 3.5113456958863316`*^9}, {
   3.511345763777651*^9, 3.5113457972709093`*^9}, {3.5113468665903883`*^9, 
   3.5113469040928535`*^9}, {3.5113478413893003`*^9, 
   3.5113478454453073`*^9}, {3.511392164143502*^9, 3.511392189899147*^9}, {
   3.5113927663045597`*^9, 3.511392768145363*^9}, 3.511393451608164*^9, {
   3.5113938899077334`*^9, 3.5113938969589458`*^9}, {3.5114124767005053`*^9, 
   3.5114124767161055`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Make output vector from output variable list", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{3.511394415176256*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeoutputvecv", "[", "outputv_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "outputv", "]"}], "\[Equal]", "0"}], "||", 
       "\[IndentingNewLine]", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"allvars", ",", 
             RowBox[{"outputv", "[", 
              RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "outputv", "]"}]}], "}"}]}], "]"}], ",", 
         "False"}], "]"}]}], ",", "\[IndentingNewLine]", "Null", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"allvars", "/.", 
          RowBox[{
           RowBox[{"outputv", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "\[Rule]", "1"}]}], "/.", 
         RowBox[{"makesub0", "[", "allvars", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "outputv", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113458830242605`*^9, 3.511345985781641*^9}, {
   3.511346033720525*^9, 3.5113460743273964`*^9}, {3.511346106151452*^9, 
   3.511346162498751*^9}, {3.511346235257279*^9, 3.511346244835696*^9}, {
   3.5113463594334974`*^9, 3.511346381647936*^9}, {3.51134641237999*^9, 
   3.5113465658062596`*^9}, {3.5113466379875865`*^9, 3.5113466563020186`*^9}, 
   3.5113467818354387`*^9, {3.5113470582991247`*^9, 3.511347126221644*^9}, {
   3.5113485869302096`*^9, 3.51134858713301*^9}, {3.511394418608262*^9, 
   3.511394426423876*^9}, {3.511394489245186*^9, 3.51139451453283*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MATLAB Export", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.511430485503873*^9, 3.5114304900278807`*^9}}],

Cell[CellGroupData[{

Cell["Notes", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.511670941983652*^9, 3.511670947459262*^9}}],

Cell[TextData[{
 "Using modified codes of Mark Barton's suspension models in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\n(http://www.ligo.caltech.edu/~e2e/SUSmodels/), the package \
\"MatlabExport.m\".\n"
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.511670873667331*^9, 3.5116709535744724`*^9}, {
  3.51167235219633*^9, 3.511672383396385*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Function to create Matlab-style strings.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113377408083353`*^9, 3.5113377965940332`*^9}, 
   3.5113378597961445`*^9, {3.51133799341038*^9, 3.511337999837591*^9}, {
   3.511338277143678*^9, 3.5113382891244993`*^9}, {3.512724634984883*^9, 
   3.512724647823617*^9}}],

Cell["Number", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511337819260873*^9, 3.511337820306075*^9}, 
   3.5113378597961445`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makematlabstring", "[", 
     RowBox[{"name_", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"NumberQ", "[", "x", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
      "name", "\[IndentingNewLine]", "<>", "\"\< = \>\"", 
       "\[IndentingNewLine]", "<>", 
       RowBox[{"ExportString", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}], "\[IndentingNewLine]", 
       "<>", "\"\<;\\n\>\""}], "\[IndentingNewLine]", ")"}], "/;", 
     "\[IndentingNewLine]", 
     RowBox[{"StringQ", "[", "name", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511336390438763*^9, 3.511336498406553*^9}, {
   3.511336561196663*^9, 3.511336640132802*^9}, {3.511336779207046*^9, 
   3.511336792201869*^9}, {3.51133683836235*^9, 3.5113369107620773`*^9}, {
   3.511337050709923*^9, 3.5113370510687237`*^9}, {3.5113374259061823`*^9, 
   3.511337442910212*^9}, 3.511337659532192*^9, 3.5113377184066954`*^9, 
   3.5113378597961445`*^9, {3.5113383718358445`*^9, 3.511338372210245*^9}}],

Cell["Vector", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511337829251291*^9, 3.5113378597961445`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makematlabstring", "[", 
     RowBox[{"name_", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"VectorQ", "[", 
        RowBox[{"x", ",", "NumberQ"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
      "name", "\[IndentingNewLine]", "<>", "\"\< = [...\\n\>\"", 
       "\[IndentingNewLine]", "<>", 
       RowBox[{"ExportString", "[", 
        RowBox[{"x", ",", "\"\<Table\>\""}], "]"}], "\[IndentingNewLine]", 
       "<>", "\"\<...;\\n]\>\""}], "\[IndentingNewLine]", ")"}], "/;", 
     "\[IndentingNewLine]", 
     RowBox[{"StringQ", "[", "name", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511336934739319*^9, 3.5113369421337323`*^9}, {
   3.5113370530187273`*^9, 3.5113370765435686`*^9}, 3.5113372088318005`*^9, {
   3.5113374501018243`*^9, 3.511337473127465*^9}, {3.511337623355729*^9, 
   3.5113376252277317`*^9}, 3.511337659532192*^9, 3.5113377193582973`*^9, 
   3.5113378597961445`*^9, {3.511338374316249*^9, 3.5113383747062497`*^9}}],

Cell["Matrix", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113378399529095`*^9, 3.5113378597961445`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makematlabstring", "[", 
     RowBox[{"name_", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"MatrixQ", "[", 
        RowBox[{"x", ",", "NumberQ"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
      "name", "\[IndentingNewLine]", "<>", "\"\< = [...\\n\>\"", 
       "\[IndentingNewLine]", "<>", 
       RowBox[{"StringJoin", "@@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ExportString", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "}"}], ",", "\"\<Table\>\""}], 
            "]"}], "<>", "\"\<;...\\n\>\""}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "<>", 
       "\"\<];\\n\>\""}], "\[IndentingNewLine]", ")"}], "/;", 
     "\[IndentingNewLine]", 
     RowBox[{"StringQ", "[", "name", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5113370902559924`*^9, 3.5113371647773232`*^9}, {
   3.5113371998305845`*^9, 3.511337224743829*^9}, {3.5113372886571407`*^9, 
   3.511337346751643*^9}, {3.5113373997917356`*^9, 3.5113374173417673`*^9}, {
   3.511337478977475*^9, 3.5113375598168173`*^9}, {3.5113376124825096`*^9, 
   3.5113376158365154`*^9}, 3.511337659532192*^9, 3.5113377209027*^9, 
   3.5113378597961445`*^9, {3.5113383769370537`*^9, 3.511338377280254*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makematlabstring", "::", "usage"}], "=", 
    "\"\<makematlabstring[name,x] creates a string containing a Matlab \n\
assignment statement. The 'name' should be a string containing a valid Matlab \
variable name \nand 'x' should be a number, a numeric vector or a numeric \
matrix.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5114305189503317`*^9, 3.5114306209433107`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Function to export values to a Matlab file, starting a new file.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{
  3.511337881760983*^9, {3.5113379870455685`*^9, 3.511338016966421*^9}, {
   3.511338266239259*^9, 3.5113383222901573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matlabexport", "[", 
     RowBox[{"fname_", ",", "args__List"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"OpenWrite", "[", "fname", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WriteString", "[", "\[IndentingNewLine]", 
          RowBox[{"file", ",", "\[IndentingNewLine]", 
           RowBox[{"makematlabstring", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "args", "}"}], "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", "args", "}"}], "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"{", "args", "}"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "file", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.511338019634026*^9, 3.5113382255855875`*^9}, 
   3.5113383222901573`*^9, {3.511349626851637*^9, 3.511349627304038*^9}, 
   3.5114306482277584`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matlabexport", "::", "usage"}], " ", "=", 
    "\"\<matlabexport[filename,{name1,x1},{name2,x2},...] exports the \
numbers, \nvectors or matrices to a file called 'filename' in Matlab \
format.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114306516753645`*^9, 3.5114307302839026`*^9}, 
   3.511430778175987*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Function to export values to a Matlab file, appending to an existing file.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511338247956027*^9, 3.5113382545236387`*^9}, 
   3.511338334551779*^9, {3.511338390431077*^9, 3.5113384077159076`*^9}, 
   3.5114307717487755`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matlabexportappend", "[", 
    RowBox[{"fname_", ",", "args__List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "file", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"file", "=", 
       RowBox[{"OpenAppend", "[", "fname", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteString", "[", "\[IndentingNewLine]", 
         RowBox[{"file", ",", "\[IndentingNewLine]", 
          RowBox[{"makematlabstring", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "args", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", "args", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "args", "}"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.511338019634026*^9, 3.5113382255855875`*^9}, {
   3.5113383222901573`*^9, 3.511338342991394*^9}, {3.511338415531521*^9, 
   3.511338416420723*^9}, {3.5113495566047134`*^9, 3.5113495574003153`*^9}, 
   3.5114307717487755`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matlabexportappend", "::", "usage"}], " ", "=", 
    "\"\<matlabexportappend[filename,{name1,x1},{name2,x2},...] \nappends the \
numbers, vectors or matrices to a file called 'filename' in Matlab \
format.\>\""}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.5114306516753645`*^9, 3.5114307717487755`*^9}}]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{885, 632},
WindowMargins->{{Automatic, 146}, {Automatic, 0}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (2008\:5e7412\:670810\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 710, 13, 105, "Subtitle",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1302, 39, 199, 3, 71, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1526, 46, 236, 4, 36, "Subsection",
 InitializationCell->True],
Cell[1765, 52, 1212, 19, 47, "Text",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[3026, 77, 175, 3, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3226, 84, 256, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[3485, 90, 961, 26, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[4449, 118, 362, 10, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[4848, 133, 331, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[5182, 140, 1280, 33, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[6465, 175, 445, 11, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[6947, 191, 236, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[7186, 197, 1417, 37, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[8606, 236, 552, 12, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[9195, 253, 214, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[9412, 259, 1474, 39, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[10889, 300, 1423, 41, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[12315, 343, 487, 11, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[12851, 360, 278, 4, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[13154, 368, 187, 3, 36, "Subsection",
 InitializationCell->True],
Cell[13344, 373, 579, 12, 83, "Text",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[13960, 390, 218, 3, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14203, 397, 544, 9, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True],
Cell[14750, 408, 898, 22, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True],
Cell[15651, 432, 1079, 24, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[16779, 462, 192, 3, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[16996, 469, 432, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True],
Cell[17431, 479, 2597, 70, 112, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True],
Cell[20031, 551, 532, 11, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[20600, 567, 363, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[20966, 576, 1308, 32, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[22277, 610, 1062, 18, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[23376, 633, 374, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[23753, 643, 1538, 38, 152, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[25294, 683, 928, 17, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[26283, 707, 225, 4, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[26533, 715, 128, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[26686, 721, 263, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[26952, 727, 595, 11, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[27550, 740, 556, 11, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[28109, 753, 605, 12, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[28763, 771, 180, 3, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[28968, 778, 393, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[29364, 788, 1205, 29, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[30572, 819, 446, 10, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[31033, 832, 224, 4, 50, "Output",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[31282, 840, 397, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[31682, 849, 1038, 23, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[32723, 874, 503, 12, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[33275, 892, 172, 3, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[33472, 899, 360, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[33835, 906, 871, 21, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[34709, 929, 514, 11, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[35260, 945, 302, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[35565, 953, 2010, 51, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[37578, 1006, 584, 13, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[38199, 1024, 388, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[38590, 1032, 718, 20, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[39311, 1054, 394, 10, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39766, 1071, 134, 2, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[39925, 1077, 125, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[40075, 1083, 126, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[40226, 1089, 727, 11, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[40956, 1102, 1410, 23, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[42403, 1130, 388, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[42794, 1138, 1026, 20, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[43869, 1164, 126, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[44020, 1170, 675, 10, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[44698, 1182, 1566, 26, 272, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46301, 1213, 363, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True],
Cell[46667, 1220, 1266, 28, 232, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[47982, 1254, 125, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[48132, 1260, 769, 11, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[48904, 1273, 2086, 33, 232, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[51027, 1311, 438, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True],
Cell[51468, 1319, 1630, 30, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[53135, 1354, 726, 11, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[53864, 1367, 1488, 24, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[55389, 1396, 392, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[55784, 1404, 843, 17, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[56688, 1428, 182, 3, 28, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[56895, 1435, 191, 3, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[57111, 1442, 262, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[57376, 1448, 2039, 51, 178, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[59418, 1501, 447, 10, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[59902, 1516, 458, 9, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True],
Cell[60363, 1527, 2237, 57, 178, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True]
}, Closed]],
Cell[62615, 1587, 404, 10, 72, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[63044, 1601, 458, 9, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True],
Cell[63505, 1612, 4408, 111, 238, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True]
}, Closed]],
Cell[67928, 1726, 612, 12, 112, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[68577, 1743, 142, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[68744, 1749, 263, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[69010, 1755, 1494, 36, 138, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[70507, 1793, 448, 10, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[70992, 1808, 535, 10, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[71530, 1820, 1697, 42, 138, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[73230, 1864, 464, 11, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[73743, 1881, 133, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[73901, 1887, 353, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[74257, 1894, 5065, 119, 412, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[79325, 2015, 524, 11, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79886, 2031, 408, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[80297, 2041, 4362, 105, 392, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[84662, 2148, 588, 13, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[85299, 2167, 135, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[85459, 2173, 262, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[85724, 2179, 937, 23, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[86664, 2204, 531, 11, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[87244, 2221, 136, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[87405, 2227, 342, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[87750, 2236, 812, 20, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[88565, 2258, 509, 11, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[89111, 2274, 239, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True],
Cell[89353, 2280, 2337, 58, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True]
}, Closed]],
Cell[91705, 2341, 360, 8, 31, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[92102, 2354, 134, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[92261, 2360, 358, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[92622, 2367, 3370, 77, 272, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[95995, 2446, 436, 10, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[96504, 2464, 154, 2, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[96683, 2470, 136, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[96822, 2474, 2635, 69, 152, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[99494, 2548, 181, 3, 21, "Subsubsection",
 InitializationCell->True],
Cell[99678, 2553, 5281, 129, 212, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[104996, 2687, 132, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[105131, 2691, 1509, 40, 72, "Input",
 InitializationCell->True],
Cell[106643, 2733, 1542, 44, 72, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[108222, 2782, 179, 3, 21, "Subsubsection",
 InitializationCell->True],
Cell[108404, 2787, 9448, 231, 352, "Input",
 InitializationCell->True],
Cell[117855, 3020, 9216, 232, 352, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[127108, 3257, 126, 2, 21, "Subsubsection",
 InitializationCell->True],
Cell[127237, 3261, 8653, 214, 292, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135939, 3481, 134, 2, 71, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[136098, 3487, 275, 4, 36, "Subsection",
 InitializationCell->True],
Cell[136376, 3493, 885, 15, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[CellGroupData[{
Cell[137286, 3512, 2202, 45, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[139491, 3559, 695, 14, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[140247, 3580, 124, 2, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[140396, 3586, 236, 4, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[140657, 3594, 700, 11, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[141360, 3607, 2449, 51, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[143812, 3660, 548, 13, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[144363, 3675, 552, 12, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[144952, 3692, 467, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[145422, 3702, 1793, 43, 112, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[147218, 3747, 734, 15, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[147955, 3764, 601, 14, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[148559, 3780, 622, 13, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[149184, 3795, 682, 13, 112, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[149915, 3814, 183, 3, 28, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[150123, 3821, 132, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[150280, 3827, 424, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[150707, 3837, 3525, 83, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[154235, 3922, 517, 12, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[154801, 3940, 132, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[154958, 3946, 251, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[155212, 3952, 3315, 89, 232, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[158564, 4046, 200, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True],
Cell[158767, 4052, 1976, 45, 152, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[160780, 4102, 249, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True],
Cell[161032, 4108, 5723, 112, 432, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[166792, 4225, 269, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True],
Cell[167064, 4233, 2490, 48, 232, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True],
Cell[169557, 4283, 523, 10, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[170153, 4301, 131, 2, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[170309, 4307, 130, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[170464, 4313, 213, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[170680, 4319, 1230, 33, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[171947, 4357, 237, 4, 26, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[172187, 4363, 2417, 62, 141, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[174641, 4430, 286, 4, 26, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[174930, 4436, 2808, 71, 141, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[177787, 4513, 181, 3, 28, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[177993, 4520, 128, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[178146, 4526, 649, 9, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True],
Cell[178798, 4537, 1396, 24, 192, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[180231, 4566, 366, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True],
Cell[180600, 4573, 817, 17, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[181466, 4596, 211, 3, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[181702, 4603, 696, 10, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True],
Cell[182401, 4615, 1394, 24, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[183832, 4644, 439, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True],
Cell[184274, 4652, 541, 13, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[184876, 4672, 139, 2, 28, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[185040, 4678, 136, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[185179, 4682, 1466, 41, 92, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[186682, 4728, 134, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[186841, 4734, 857, 14, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[187701, 4750, 5121, 113, 451, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[192859, 4868, 615, 10, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[193477, 4880, 9189, 189, 992, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[202669, 5071, 568, 12, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[203286, 5089, 136, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[203447, 5095, 390, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True],
Cell[203840, 5104, 941, 20, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]],
Cell[204796, 5127, 323, 7, 52, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[205144, 5138, 1038, 16, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[206185, 5156, 4161, 101, 432, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[210383, 5262, 634, 11, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True],
Cell[211020, 5275, 10478, 217, 1032, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True],
Cell[221501, 5494, 517, 11, 92, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[222079, 5512, 225, 4, 28, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[222329, 5520, 136, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[222468, 5524, 7785, 168, 553, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[230256, 5694, 558, 10, 112, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[230851, 5709, 130, 2, 27, "Subsubsection",
 InitializationCell->True],
Cell[230984, 5713, 4621, 114, 471, "Input",
 InitializationCell->True],
Cell[235608, 5829, 567, 10, 112, "Input",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[236236, 5846, 129, 2, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[236390, 5852, 229, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[236622, 5858, 3089, 73, 412, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[239714, 5933, 430, 10, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[240193, 5949, 127, 2, 41, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[240345, 5955, 246, 4, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[240616, 5963, 309, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[240928, 5970, 2297, 54, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[243262, 6029, 381, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True],
Cell[243646, 6037, 2391, 55, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[246074, 6097, 282, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[246359, 6103, 2810, 65, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[249206, 6173, 182, 3, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[249391, 6178, 2055, 48, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[251495, 6232, 130, 2, 36, "Subsection",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[251650, 6238, 167, 3, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[251820, 6243, 424, 10, 65, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[252281, 6258, 381, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[252665, 6266, 196, 4, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[252864, 6272, 1216, 27, 192, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[254083, 6301, 170, 3, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[254256, 6306, 1195, 27, 192, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[255454, 6335, 172, 3, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[255629, 6340, 1736, 40, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]],
Cell[257380, 6383, 487, 10, 92, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[257892, 6397, 313, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[258208, 6406, 1638, 40, 272, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True],
Cell[259849, 6448, 479, 11, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[260365, 6464, 348, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[260716, 6473, 1648, 39, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[262367, 6514, 465, 10, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
